/* Downloaded from github.com on November 9th, 2015. */

// Scheme numerical tower in JavaScript.
// Copyright (c) 2011,2012 by John Tobey <jtobey@john-edwin-tobey.org>

/* biginteger.js */
function BigInteger(e,t){if(!(this instanceof BigInteger))return e instanceof BigInteger?e:"undefined"==typeof e?BigInteger.ZERO:BigInteger.parse(e);for(e=e||[];e.length&&!e[e.length-1];)--e.length;this._d=e,this._s=e.length?t||1:0}Array.prototype.map||(Array.prototype.map=function(e){var t=this.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=new Array(t),n=arguments[1],i=0;t>i;i++)i in this&&(r[i]=e.call(n,this[i],i,this));return r}),BigInteger.base=1e7,BigInteger.base_log10=7,BigInteger.init=function(){BigInteger.ZERO=new BigInteger([],0),BigInteger.ONE=new BigInteger([1],1),BigInteger.M_ONE=new BigInteger(BigInteger.ONE._d,-1),BigInteger._0=BigInteger.ZERO,BigInteger._1=BigInteger.ONE,BigInteger.small=[BigInteger.ZERO,BigInteger.ONE,new BigInteger([2],1),new BigInteger([3],1),new BigInteger([4],1),new BigInteger([5],1),new BigInteger([6],1),new BigInteger([7],1),new BigInteger([8],1),new BigInteger([9],1),new BigInteger([10],1),new BigInteger([11],1),new BigInteger([12],1),new BigInteger([13],1),new BigInteger([14],1),new BigInteger([15],1),new BigInteger([16],1),new BigInteger([17],1),new BigInteger([18],1),new BigInteger([19],1),new BigInteger([20],1),new BigInteger([21],1),new BigInteger([22],1),new BigInteger([23],1),new BigInteger([24],1),new BigInteger([25],1),new BigInteger([26],1),new BigInteger([27],1),new BigInteger([28],1),new BigInteger([29],1),new BigInteger([30],1),new BigInteger([31],1),new BigInteger([32],1),new BigInteger([33],1),new BigInteger([34],1),new BigInteger([35],1),new BigInteger([36],1)]},BigInteger.init(),BigInteger.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),BigInteger.prototype.toString=function(e){if(e=+e||10,2>e||e>36)throw new Error("illegal radix "+e+".");if(0===this._s)return"0";if(10===e){var t=this._s<0?"-":"";t+=this._d[this._d.length-1].toString();for(var r=this._d.length-2;r>=0;r--){for(var n=this._d[r].toString();n.length<BigInteger.base_log10;)n="0"+n;t+=n}return t}var i=BigInteger.digits;e=BigInteger.small[e];for(var g,s=this._s,o=this.abs(),a=[];0!==o._s;){var I=o.divRem(e);o=I[0],g=I[1],a.push(i[g.valueOf()])}return(0>s?"-":"")+a.reverse().join("")},BigInteger.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/],BigInteger.parse=function(e,t){function r(e){return e=e.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e"),e.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(e,t,r,n,i){i=+i;var g=0>i,s=r.length+i;e=(g?r:n).length,i=(i=Math.abs(i))>=e?i-e+g:0;var o=new Array(i+1).join("0"),a=r+n;return(t||"")+(g?a=o+a:a+=o).substr(0,s+=g?o.length:0)+(s<a.length?"."+a.substr(s):"")})}e=e.toString(),("undefined"==typeof t||10===+t)&&(e=r(e));var n=/^([+\-]?)(0[xXcCbB])?([0-9A-Za-z]*)(?:\.\d*)?$/.exec(e);if(n){var i=n[1]||"+",g=n[2]||"",s=n[3]||"";if("undefined"==typeof t)t="0x"===g||"0X"===g?16:"0c"===g||"0C"===g?8:"0b"===g||"0B"===g?2:10;else if(2>t||t>36)throw new Error("Illegal radix "+t+".");if(t=+t,!BigInteger.radixRegex[t].test(s))throw new Error("Bad digit for radix "+t);if(s=s.replace(/^0+/,"").split(""),0===s.length)return BigInteger.ZERO;if(i="-"===i?-1:1,10==t){for(var o=[];s.length>=BigInteger.base_log10;)o.push(parseInt(s.splice(-BigInteger.base_log10).join(""),10));return o.push(parseInt(s.join(""),10)),new BigInteger(o,i)}if(t===BigInteger.base)return new BigInteger(s.map(Number).reverse(),i);var o=BigInteger.ZERO;t=BigInteger.small[t];for(var a=BigInteger.small,I=0;I<s.length;I++)o=o.multiply(t).add(a[parseInt(s[I],36)]);return new BigInteger(o._d,i)}throw new Error("Invalid BigInteger format: "+e)},BigInteger.prototype.add=function(e){if(0===this._s)return BigInteger(e);if(e=BigInteger(e),0===e._s)return this;if(this._s!==e._s)return e=e.negate(),this.subtract(e);for(var t,r=this._d,n=e._d,i=r.length,g=n.length,s=new Array(Math.max(i,g)+1),o=Math.min(i,g),a=0,I=0;o>I;I++)t=r[I]+n[I]+a,s[I]=t%BigInteger.base,a=t/BigInteger.base|0;for(g>i&&(r=n,i=g),I=o;a&&i>I;I++)t=r[I]+a,s[I]=t%BigInteger.base,a=t/BigInteger.base|0;for(a&&(s[I]=a);i>I;I++)s[I]=r[I];return new BigInteger(s,this._s)},BigInteger.prototype.negate=function(){return new BigInteger(this._d,-this._s)},BigInteger.prototype.abs=function(){return this._s<0?this.negate():this},BigInteger.prototype.subtract=function(e){if(0===this._s)return BigInteger(e).negate();if(e=BigInteger(e),0===e._s)return this;if(this._s!==e._s)return e=e.negate(),this.add(e);var t,r=this;this._s<0&&(t=r,r=new BigInteger(e._d,1),e=new BigInteger(t._d,1));var n=r.compareAbs(e);if(0===n)return BigInteger.ZERO;0>n&&(t=e,e=r,r=t);var i,g,s=r._d,o=e._d,a=s.length,I=o.length,B=new Array(a),h=0;for(i=0;I>i;i++)g=s[i]-h-o[i],0>g?(g+=BigInteger.base,h=1):h=0,B[i]=g;for(i=I;a>i;i++){if(g=s[i]-h,!(0>g)){B[i++]=g;break}g+=BigInteger.base,B[i]=g}for(;a>i;i++)B[i]=s[i];return new BigInteger(B,n)},function(){function e(e,t){for(var r=e._d,n=r.slice(),i=0;;){var g=(r[i]||0)+1;if(n[i]=g%BigInteger.base,g<=BigInteger.base-1)break;++i}return new BigInteger(n,t)}function t(e,t){for(var r=e._d,n=r.slice(),i=0;;){var g=(r[i]||0)-1;if(!(0>g)){n[i]=g;break}n[i]=g+BigInteger.base,++i}return new BigInteger(n,t)}BigInteger.prototype.next=function(){switch(this._s){case 0:return BigInteger.ONE;case-1:return t(this,-1);default:return e(this,1)}},BigInteger.prototype.prev=function(){switch(this._s){case 0:return BigInteger.M_ONE;case-1:return e(this,-1);default:return t(this,1)}}}(),BigInteger.prototype.compareAbs=function(e){if(this===e)return 0;if(!(e instanceof BigInteger)){if(!isFinite(e))return isNaN(e)?e:-1;e=BigInteger(e)}if(0===this._s)return 0!==e._s?-1:0;if(0===e._s)return 1;var t=this._d.length,r=e._d.length;if(r>t)return-1;if(t>r)return 1;for(var n=this._d,i=e._d,g=t-1;g>=0;g--)if(n[g]!==i[g])return n[g]<i[g]?-1:1;return 0},BigInteger.prototype.compare=function(e){if(this===e)return 0;if(e=BigInteger(e),0===this._s)return-e._s;if(this._s===e._s){var t=this.compareAbs(e);return t*this._s}return this._s},BigInteger.prototype.isUnit=function(){return this===BigInteger.ONE||this===BigInteger.M_ONE||1===this._d.length&&1===this._d[0]},BigInteger.prototype.multiply=function(e){if(0===this._s)return BigInteger.ZERO;if(e=BigInteger(e),0===e._s)return BigInteger.ZERO;if(this.isUnit())return this._s<0?e.negate():e;if(e.isUnit())return e._s<0?this.negate():this;if(this===e)return this.square();var t,r=this._d.length>=e._d.length,n=(r?this:e)._d,i=(r?e:this)._d,g=n.length,s=i.length,o=g+s,a=new Array(o);for(t=0;o>t;t++)a[t]=0;for(t=0;s>t;t++){for(var I,B=0,h=i[t],u=g+t,f=t;u>f;f++)I=a[f]+h*n[f-t]+B,B=I/BigInteger.base|0,a[f]=I%BigInteger.base|0;B&&(I=a[f]+B,B=I/BigInteger.base|0,a[f]=I%BigInteger.base)}return new BigInteger(a,this._s*e._s)},BigInteger.prototype.multiplySingleDigit=function(e){if(0===e||0===this._s)return BigInteger.ZERO;if(1===e)return this;var t;if(1===this._d.length)return t=this._d[0]*e,t>=BigInteger.base?new BigInteger([t%BigInteger.base|0,t/BigInteger.base|0],1):new BigInteger([t],1);if(2===e)return this.add(this);if(this.isUnit())return new BigInteger([e],1);for(var r=this._d,n=r.length,i=n+1,g=new Array(i),s=0;i>s;s++)g[s]=0;for(var o=0,a=0;n>a;a++)t=e*r[a]+o,o=t/BigInteger.base|0,g[a]=t%BigInteger.base|0;return o&&(t=o,o=t/BigInteger.base|0,g[a]=t%BigInteger.base),new BigInteger(g,1)},BigInteger.prototype.square=function(){if(0===this._s)return BigInteger.ZERO;if(this.isUnit())return BigInteger.ONE;var e,t,r,n,i=this._d,g=i.length,s=new Array(g+g+1);for(n=0;g>n;n++)r=2*n,e=i[n]*i[n],t=e/BigInteger.base|0,s[r]=e%BigInteger.base,s[r+1]=t;for(n=0;g>n;n++){t=0,r=2*n+1;for(var o=n+1;g>o;o++,r++)e=i[o]*i[n]*2+s[r]+t,t=e/BigInteger.base|0,s[r]=e%BigInteger.base;r=g+n;var a=t+s[r];t=a/BigInteger.base|0,s[r]=a%BigInteger.base,s[r+1]+=t}return new BigInteger(s,1)},BigInteger.prototype.quotient=function(e){return this.divRem(e)[0]},BigInteger.prototype.divide=BigInteger.prototype.quotient,BigInteger.prototype.remainder=function(e){return this.divRem(e)[1]},BigInteger.prototype.divRem=function(e){if(e=BigInteger(e),0===e._s)throw new Error("Divide by zero");if(0===this._s)return[BigInteger.ZERO,BigInteger.ZERO];if(1===e._d.length)return this.divRemSmall(e._s*e._d[0]);switch(this.compareAbs(e)){case 0:return[this._s===e._s?BigInteger.ONE:BigInteger.M_ONE,BigInteger.ZERO];case-1:return[BigInteger.ZERO,this]}var t,r=this._s*e._s,n=e.abs(),i=this._d.slice(),g=(e._d.length,i.length,[]),s=new BigInteger([],1);for(s._s=1;i.length;)if(s._d.unshift(i.pop()),s=new BigInteger(s._d,1),s.compareAbs(e)<0)g.push(0);else{if(0===s._s)t=0;else{var o=s._d.length,a=n._d.length,I=s._d[o-1]*BigInteger.base+s._d[o-2],B=n._d[a-1]*BigInteger.base+n._d[a-2];s._d.length>n._d.length&&(I=(I+1)*BigInteger.base),t=Math.ceil(I/B)}do{var h=n.multiplySingleDigit(t);if(h.compareAbs(s)<=0)break;t--}while(t);if(g.push(t),t){var u=s.subtract(h);s._d=u._d.slice()}}return[new BigInteger(g.reverse(),r),new BigInteger(s._d,this._s)]},BigInteger.prototype.divRemSmall=function(e){var t;if(e=+e,0===e)throw new Error("Divide by zero");var r=0>e?-1:1,n=this._s*r;if(e=Math.abs(e),1>e||e>=BigInteger.base)throw new Error("Argument out of range");if(0===this._s)return[BigInteger.ZERO,BigInteger.ZERO];if(1===e||-1===e)return[1===n?this.abs():new BigInteger(this._d,n),BigInteger.ZERO];if(1===this._d.length){var i=new BigInteger([this._d[0]/e|0],1);return t=new BigInteger([this._d[0]%e|0],1),0>n&&(i=i.negate()),this._s<0&&(t=t.negate()),[i,t]}for(var g,s=this._d.slice(),o=new Array(s.length),a=0,I=0,B=0;s.length;)if(a=a*BigInteger.base+s[s.length-1],e>a)o[B++]=0,s.pop(),I=BigInteger.base*I+a;else{g=0===a?0:a/e|0;var h=e*g;I=a-h,o[B++]=g,g?(s.pop(),a=I):s.pop()}return t=new BigInteger([I],1),this._s<0&&(t=t.negate()),[new BigInteger(o.reverse(),n),t]},BigInteger.prototype.isEven=function(){var e=this._d;return 0===this._s||0===e.length||e[0]%2===0},BigInteger.prototype.isOdd=function(){return!this.isEven()},BigInteger.prototype.sign=function(){return this._s},BigInteger.prototype.isPositive=function(){return this._s>0},BigInteger.prototype.isNegative=function(){return this._s<0},BigInteger.prototype.isZero=function(){return 0===this._s},BigInteger.prototype.exp10=function(e){if(e=+e,0===e)return this;if(Math.abs(e)>Number(BigInteger.MAX_EXP))throw new Error("exponent too large in BigInteger.exp10");if(e>0){for(var t=new BigInteger(this._d.slice(),this._s);e>=BigInteger.base_log10;e-=BigInteger.base_log10)t._d.unshift(0);return 0==e?t:(t._s=1,t=t.multiplySingleDigit(Math.pow(10,e)),this._s<0?t.negate():t)}if(-e>=this._d.length*BigInteger.base_log10)return BigInteger.ZERO;var t=new BigInteger(this._d.slice(),this._s);for(e=-e;e>=BigInteger.base_log10;e-=BigInteger.base_log10)t._d.shift();return 0==e?t:t.divRemSmall(Math.pow(10,e))[0]},BigInteger.prototype.pow=function(e){if(this.isUnit())return this._s>0?this:BigInteger(e).isOdd()?this:this.negate();if(e=BigInteger(e),0===e._s)return BigInteger.ONE;if(e._s<0){if(0===this._s)throw new Error("Divide by zero");return BigInteger.ZERO}if(0===this._s)return BigInteger.ZERO;if(e.isUnit())return this;if(e.compareAbs(BigInteger.MAX_EXP)>0)throw new Error("exponent too large in BigInteger.pow");for(var t=this,r=BigInteger.ONE,n=BigInteger.small[2];e.isPositive();){if(e.isOdd()&&(r=r.multiply(t),e.isUnit()))return r;t=t.square(),e=e.quotient(n)}return r},BigInteger.prototype.modPow=function(e,t){for(var r=BigInteger.ONE,n=this;e.isPositive();)e.isOdd()&&(r=r.multiply(n).remainder(t)),e=e.quotient(BigInteger.small[2]),e.isPositive()&&(n=n.square().remainder(t));return r},BigInteger.prototype.log=function(){switch(this._s){case 0:return-(1/0);case-1:return NaN}var e=this._d.length;if(e*BigInteger.base_log10<30)return Math.log(this.valueOf());var t=Math.ceil(30/BigInteger.base_log10),r=this._d.slice(e-t);return Math.log(new BigInteger(r,1).valueOf())+(e-t)*Math.log(BigInteger.base)},BigInteger.prototype.valueOf=function(){return parseInt(this.toString(),10)},BigInteger.prototype.toJSValue=function(){return parseInt(this.toString(),10)},BigInteger.MAX_EXP=BigInteger(2147483647),function(){function e(e){return function(t){return e.call(BigInteger(t))}}function t(e){return function(t,r){return e.call(BigInteger(t),BigInteger(r))}}function r(e){return function(t,r,n){return e.call(BigInteger(t),BigInteger(r),BigInteger(n))}}!function(){var n,i,g="toJSValue,isEven,isOdd,sign,isZero,isNegative,abs,isUnit,square,negate,isPositive,toString,next,prev,log".split(","),s="compare,remainder,divRem,subtract,add,quotient,divide,multiply,pow,compareAbs".split(","),o=["modPow"];for(n=0;n<g.length;n++)i=g[n],BigInteger[i]=e(BigInteger.prototype[i]);for(n=0;n<s.length;n++)i=s[n],BigInteger[i]=t(BigInteger.prototype[i]);for(n=0;n<o.length;n++)i=o[n],BigInteger[i]=r(BigInteger.prototype[i]);BigInteger.exp10=function(e,t){return BigInteger(e).exp10(t)}}()}(),"undefined"!=typeof exports&&(exports.BigInteger=BigInteger);
/* schemeNumber.js */
var SchemeNumber=function(){function PluginContainer(t){"use strict";function e(t,e,n){var r=!1;for(var i in t){if(void 0!==e[i]&&e[i]!==t[i])throw Error("Conflicting changes to "+i);n&&(n[i]=t[i]),e[i]=t[i],r=!0}return r}if(!(this instanceof PluginContainer))throw Error("Usage: new PluginContainer()");var n=this,r=[],i=Object.create(null),o={fire:function(t){function e(e){e.call(e,n,t)}r.forEach(e)},subscribe:function(t){r.push(t)},unsubscribe:function(t){function e(e){return e!==t}r=r.filter(e)}};n.onChange=o,n.extend=function(){var t,n=Object.create(null),r=arguments[0];if("object"!=typeof r){if(1&arguments.length)throw Error("extend: Wrong argument types");for(r=Object.create(null),t=0;t<arguments.length;t+=2){if(arguments[t]in r)throw Error("extend: "+arguments[t]+" given more than once");r[arguments[t]]=arguments[t+1]}}e(r,i,n)&&o.fire(n)},n.get=function(t){return i[t]},n.list=function(){return Object.keys(i)},t&&n.extend(t)}function assert(t){if(!t)throw new Error("assertion failed")}function getEs5Globals(){return{NaN:NaN,Infinity:1/0,undefined:void 0,eval:eval,parseInt:parseInt,parseFloat:parseFloat,isNaN:isNaN,isFinite:isFinite,decodeURI:decodeURI,decodeURIComponent:decodeURIComponent,encodeURI:encodeURI,encodeURIComponent:encodeURIComponent,Object:Object,Function:Function,Array:Array,String:String,Boolean:Boolean,Number:Number,Date:Date,RegExp:RegExp,Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError,Math:Math,JSON:JSON}}function implementUncurry(t){var e=t.get("es5globals"),n=e.Object.create(null);return n.uncurry=e.Function.prototype.bind.bind(e.Function.prototype.call),n}function defineGenericFunctions(t){"use strict";function e(t,e,n){i[t]=r.defGeneric(t,e,n)}var n=t.get("es5globals"),r=t.get("Dispatch"),i=n.Object.create(null);return e("toSchemeNumber",1),e("numberToString",1,3),e("isExact",1),e("isInexact",1),e("isComplex",1),e("isReal",1),e("isRational",1),e("isInteger",1),e("isZero",1),e("toExact",1),e("toInexact",1),e("negate",1),e("reciprocal",1),e("eq",2),e("ne",2),e("add",2),e("subtract",2),e("multiply",2),e("divide",2),e("square",1),e("realPart",1),e("imagPart",1),e("magnitude",1),e("angle",1),e("conjugate",1),e("expt",2),e("exp",1),e("sqrt",1),e("log",1),e("asin",1),e("acos",1),e("atan",1),e("sin",1),e("cos",1),e("tan",1),e("SN_isFinite",1),e("SN_isInfinite",1),e("SN_isNaN",1),e("isUnit",1),e("abs",1),e("isPositive",1),e("isNegative",1),e("sign",1),e("floor",1),e("ceiling",1),e("truncate",1),e("round",1),e("compare",2),e("gt",2),e("lt",2),e("ge",2),e("le",2),e("divAndMod",2),e("div",2),e("mod",2),e("atan2",2),e("numerator",1),e("denominator",1),e("numeratorAndDenominator",1),e("isEven",1),e("isOdd",1),e("exactIntegerSqrt",1),e("exp10",1,2),e("gcdNonnegative",2),e("divideReduced",2),e("bitwiseNot",1),e("bitwiseAnd",2),e("bitwiseIor",2),e("bitwiseXor",2),e("bitCount",1),e("bitLength",1),e("firstBitSet",1),e("isBitSet",1,2),e("copyBit",1,3),e("bitField",1,3),e("copyBitField",2,4),e("bitShift",1,2),e("rotateBitField",1,4),e("reverseBitField",1,3),i}function defineSchemeNumberType(t){"use strict";function e(){}function n(t){return c?c(this,t):"[object SchemeNumber]"}function r(){return n()}function i(){return u}function o(){return c?c(this):"SchemeNumber"}var a=t.get("es5globals"),u=a.NaN,s=a.Object.create(null),c=t.get("numberToString"),g=t.get("Dispatch");return e.prototype=new Number,e.prototype.toFixed=o,e.prototype.toExponential=o,e.prototype.toPrecision=o,e.prototype.toString=n,e.prototype.toLocaleString=r,e.prototype.valueOf=i,g.defClass("SchemeNumber",{ctor:e}),s.SchemeNumberType=e,s}function defineDebugFunction(t){"use strict";function e(){var t;try{t=this.toString()}catch(e){try{t=a(this)}catch(e){t="?"}}return"SchemeNumber("+t+")"}var n=t.get("es5globals"),r=t.get("uncurry"),i=t.get("Dispatch"),o=t.get("SchemeNumberType"),a=r(n.Object.prototype.toString),u=n.Object.create(null);return u.debug=i.defGeneric("debug",1),u.debug.def(o,e),u}function implementCoreLibrary(t){"use strict";function e(t,e){function n(t,e){try{return Xt(Gt(t),Gt(e))}catch(n){return ve}}Gt=t.get("nativeToExactInteger"),Lt=t.get("parseExactInteger"),Ut=t.get("nativeToInexact"),kt=t.get("parseInexact"),$t=t.get("divideReducedNotByOne"),Xt=t.get("exactRectangular"),Yt=t.get("inexactRectangular"),zt=t.get("exactPolar"),Wt=t.get("inexactPolar");var r=ue.Object.create(null);(e.nativeToExactInteger||e.exactRectangular)&&(Kt=r.I=n(0,1),te=r.MINUS_I=n(0,-1)),e.nativeToExactInteger&&(Jt=r.ZERO=Gt(0),Qt=r.ONE=Gt(1),Vt=r.TWO=Gt(2),Ht=r.MINUS_ONE=Gt(-1)),e.nativeToInexact&&(ee=r.INEXACT_ZERO=Ut(0),ne=r.INEXACT_ONE=Ut(1),re=r.PI=Ut(pe),ie=r.INFINITY=Ut(xe),oe=r.MINUS_INFINITY=Ut(-xe),ae=r.NAN=Ut(be)),t.extend(r)}function n(){return!1}function r(){return!0}function i(){return this}function o(){return Jt}function a(){return Qt}function u(t){return t}function s(t,e){return q(t)?Yt(t,k(e)):q(e)?Yt(k(t),e):Xt(t,e)}function c(t,e){return q(t)?Wt(t,k(e)):q(e)?Wt(k(t),e):zt(t,e)}function g(t,e,n){var r,i,o="SchemeNumber: "+t+": "+e;if(arguments.length>2)for(o+=": ",r=2;;){i=arguments[r];try{o+=P(i)}catch(a){try{o+=i}catch(a){o+="?"}}if(r++,r===arguments.length)break;o+=", "}throw new ue.Error(o)}function l(){var t=ce(arguments);E.raise.apply(E,t),g.apply(this,t)}function f(){l("&assertion","division by exact zero")}function d(t,e,n){if(t!==!1&&B(t)||lose(),!j(t)){var r=pt(t),i=e-_e(it(r)/me)-1,o=K(Vt,Gt(he(i)));0>i&&(o=G(o));for(var a=W(r,o),u=K(Vt,Gt(e));St(a,u);)a=J(a,Vt),o=J(o,Vt);for(var s=Y(a,a);It(s,u);s=Y(a,a))a=s,o=Y(o,o);var c=J(yt(a),o);_t(t)&&(c=L(c)),t=c}return n||(t=k(t)),t}function m(t){return B(t)||l("&assertion","not a real number",t),t}function p(t){return t=E(t),B(t)||m(t),t}function h(t){return D(t)||l("&assertion","not a rational number",t),t}function _(t){return t=E(t),D(t)||h(t),t}function v(t){return t=E(t),Z(t)||l("&assertion","not an integer",t),t}function x(t){return t=E(t),Z(t)||v(t),t}function b(t){return q(t)&&l("&assertion","inexact number",t),t}function N(t){return t instanceof I}function y(t,e,n){function r(){throw we}function i(t){return t===!1?r():t}function o(t){n!==ve&&r(),n=t}function a(t){e&&r(),e=t}function u(t,i){return de(Ce[e],t)||r(),n===!1?10===e?kt(i,t):k(Lt(i,t,e)):Lt(i,t,e)}function g(t){if(de(Ie,t))switch(n&&r(),t){case"+inf.0":return ie;case"-inf.0":return oe;default:return ae}var o=1;switch(t[0]){case"-":o=-1;case"+":t=le(t,1)}var a=ge(t,"/");if(-1!=a)return J(u(le(t,0,a),o),u(le(t,a+1),1));if(10!==e)return u(t,o);var s=ge(t,"|");if(-1!==s){var c=le(t,s+1);de(Ce[10],c)||r(),t=le(t,0,s);var l=Ne(c,10);if(0===l)t="0.0";else if(53>l)return i(d(y(t,e,!0),l,n))}t=fe(t,Se,"e");var f=ge(t,"."),m=ge(t,"e");if(-1===f&&-1===m)return u(t,o);if(de(Fe,t)||r(),!n)return kt(o,t);var p,h=le(t,0,-1===f?m:f),_=Jt;return-1===m?p=le(t,f+1):(p=-1===f?"":le(t,f+1,m),_=g(le(t,m+1))),Dt(Lt(o,h+p),z(_,Gt(p.length)))}function f(t){var r=ge(t,"@");if(-1!==r){var i=c(g(le(t,0,r)),g(le(t,r+1)));return n&&q(i)&&(i=i),i}if("i"!==t[t.length-1])return g(t);if("i"===t)return n===!1?Yt(ee,ne):Kt;if("-i"===t)return n===!1?Yt(ee,L(ne)):te;var o,a,u=(10===e?Ee:Re).exec(t);return u?(o=u[1],a=u[2],o=o?g(o):n===!1?ee:Jt,a="+"===a?Qt:"-"===a?Ht:g(a)):(o=n===!1?ee:Jt,a=g(le(t,0,t.length-1))),s(o,a)}if((!e||10===e)&&de(/^-?[0-9]{1,15}$/,t))return n===!1?Ut(Ne(t,10)):Gt(Ne(t,10));var m=0;try{for(;"#"===t[m];){switch(t[m+1]){case"i":case"I":o(!1);break;case"e":case"E":o(!0);break;case"b":case"B":a(2);break;case"o":case"O":a(8);break;case"d":case"D":a(10);break;case"x":case"X":a(16);break;default:return!1}m+=2}return e=e||10,f(le(t,m))}catch(p){if(p===we)return!1;throw t==ve&&l("&assertion","missing argument"),p}}var E,R,I,S,F,C,w,O,T,P,M,q,A,B,D,Z,j,U,k,L,G,$,X,Y,z,W,J,Q,V,H,K,K,tt,et,nt,rt,it,ot,at,ut,st,ct,gt,lt,ft,dt,mt,pt,ht,_t,vt,xt,bt,Nt,yt,Et,Rt,It,St,Ft,Ct,wt,Ot,Tt,Pt,Mt,qt,At,Bt,Dt,Zt,jt;E=t.get("SchemeNumber"),I=t.get("SchemeNumberType"),S=t.get("Complex"),F=t.get("Real"),C=t.get("InexactReal"),w=t.get("ExactReal"),O=t.get("ExactRational"),T=t.get("ExactInteger"),R=t.get("toSchemeNumber"),P=t.get("numberToString"),M=t.get("isExact"),q=t.get("isInexact"),A=t.get("isComplex"),B=t.get("isReal"),D=t.get("isRational"),Z=t.get("isInteger"),j=t.get("isZero"),U=t.get("toExact"),k=t.get("toInexact"),L=t.get("negate"),G=t.get("reciprocal"),$=t.get("eq"),X=t.get("ne"),Y=t.get("add"),z=t.get("subtract"),W=t.get("multiply"),J=t.get("divide"),Q=t.get("square"),V=t.get("realPart"),H=t.get("imagPart"),K=t.get("expt"),K=t.get("expt"),tt=t.get("exp"),et=t.get("magnitude"),nt=t.get("angle"),rt=t.get("sqrt"),it=t.get("log"),ot=t.get("asin"),at=t.get("acos"),ut=t.get("atan"),st=t.get("sin"),ct=t.get("cos"),gt=t.get("tan"),lt=t.get("SN_isFinite"),ft=t.get("SN_isInfinite"),dt=t.get("SN_isNaN"),mt=t.get("isUnit"),pt=t.get("abs"),ht=t.get("isPositive"),_t=t.get("isNegative"),vt=t.get("sign"),xt=t.get("floor"),bt=t.get("ceiling"),Nt=t.get("truncate"),yt=t.get("round"),Et=t.get("compare"),Rt=t.get("gt"),It=t.get("lt"),St=t.get("ge"),Ft=t.get("le"),Ct=t.get("divAndMod"),wt=t.get("div"),Ot=t.get("mod"),Tt=t.get("atan2"),Pt=t.get("numerator"),Mt=t.get("denominator"),qt=t.get("numeratorAndDenominator"),At=t.get("isEven"),Bt=t.get("isOdd"),Dt=t.get("exp10"),Zt=t.get("gcdNonnegative"),jt=t.get("divideReduced");var Ut,kt,Lt,Gt,$t,Xt,Yt,zt,Wt,Jt,Qt,Vt,Ht,Kt,te,ee,ne,re,ie,oe,ae,ue=t.get("es5globals"),se=t.get("uncurry"),ce=se(ue.Array.prototype.slice),ge=(se(ue.Array.prototype.join),se(ue.Number.prototype.toString),se(ue.String.prototype.indexOf)),le=se(ue.String.prototype.substring),fe=se(ue.String.prototype.replace),de=se(ue.RegExp.prototype.test),me=(ue.Math.LN10,ue.Math.LN2),pe=ue.Math.PI,he=ue.Math.abs,_e=ue.Math.floor,ve=(ue.Math.pow,ue.Math.LN2,ue.Math.LN10,ue.Math.PI,ue.undefined),xe=ue.Infinity,be=ue.NaN,Ne=ue.parseInt,ye=(ue.isNaN,ue.isFinite,ue.Object.create(null));t.onChange.subscribe(e),e(t,{});var Ee=/^(.*[^a-zA-Z]|)([-+].*)i$/,Re=/^(.*)([-+].*)i$/,Ie=/^[-+](nan|inf)\.0$/,Se=/[eEsSfFdDlL]/,Fe=/^([0-9]+\.?|[0-9]*\.[0-9]+)([eEsSfFdDlL][-+]?[0-9]+)?$/,Ce={2:/^[01]+$/,8:/^[0-7]+$/,10:/^[0-9]+$/,16:/^[0-9a-fA-F]+$/},we=new ue.Object;return ye.I=Kt,ye.ZERO=Jt,ye.ONE=Qt,ye.TWO=Vt,ye.MINUS_ONE=Ht,ye.INEXACT_ZERO=ee,ye.INEXACT_ONE=ne,ye.PI=re,ye.INFINITY=ie,ye.MINUS_INFINITY=oe,ye.NAN=ae,ye.raise=l,ye.defaultRaise=g,ye.raiseDivisionByExactZero=f,ye.stringToNumber=y,ye.isNumber=N,ye.assertReal=m,ye.toReal=p,ye.assertRational=h,ye.toRational=_,ye.assertInteger=v,ye.toInteger=x,ye.assertExact=b,ye.makeRectangular=s,ye.makePolar=c,ye.truncateToPrecision=d,ye.retFalse=n,ye.retTrue=r,ye.retThis=i,ye.retZero=o,ye.retOne=a,ye.retFirst=u,ye}function implementRnrsBase(t){function e(t){R=t.get("ZERO"),I=t.get("ONE"),S=t.get("MINUS_ONE"),F=t.get("INEXACT_ZERO"),C=t.get("NAN"),w=t.get("raise"),O=t.get("isNumber"),T=t.get("assertReal"),P=t.get("toReal"),M=t.get("toRational"),q=t.get("toInteger"),A=t.get("assertExact"),B=t.get("makeRectangular"),D=t.get("makePolar")}function n(t,e){var n,r="Function";try{n=e.callee}catch(i){}if(n)for(name in $t)if($t[name]===n){r+=" '"+name+"'";break}w("&assertion",r+" expected "+t+" argument"+("1"==t?"":"s")+", got "+e.length)}function r(t){1===t.length||n(1,t)}function i(t){2===t.length||n(2,t)}function o(t){t.length>0||n("1 or more",t)}function a(t){t.length>1||n("2 or more",t)}function u(t,e){return 2===arguments.length||i(arguments),t===e?!0:O(t)&&O(e)?Q(t,e)&&j(t)===j(e):!1}function s(t){return 1===arguments.length||r(arguments),O(t)}function c(t){return 1===arguments.length||r(arguments),O(t)&&k(t)}function g(t){return 1===arguments.length||r(arguments),O(t)&&L(t)}function l(t){return 1===arguments.length||r(arguments),O(t)&&G(t)}function f(t){return 1===arguments.length||r(arguments),O(t)&&$(t)}function d(t){return 1===arguments.length||r(arguments),O(t)&&k(t)&&X(rt(t))}function m(t){return 1===arguments.length||r(arguments),d(t)&&G(nt(t))}function p(t){return 1===arguments.length||r(arguments),d(t)&&$(nt(t))}function h(t,e){var n=arguments.length;n>1||a(arguments),t=y(t);for(var r=1;n>r;r++)if(!Q(t,y(arguments[r])))return!1;return!0}function _(t,e){function n(n){return 1===arguments.length||r(arguments),e(t(n))}return n}function v(t){function e(e,n){var r=arguments.length;if(r>1||a(arguments),n=P(n),!t(P(e),n))return!1;for(var i=2;r>i;i++){var o=P(arguments[i]);if(!t(n,o))return!1;n=o}return!0}return e}function x(t){function e(e){var n=arguments.length;n>0||o(arguments);for(var r=P(e),i=j(r),a=1;n>a;a++){var u=P(arguments[a]);if(vt(u))return u;i&&(i=j(u),i||(r=z(r))),t(u,r)!==!1&&(r=u)}return i?r:z(r)}return e}function b(t,e){function n(n,r){if(2===arguments.length||i(arguments),n=P(n),r=P(r),ht(n)||w("&assertion","div/mod first argument is not finite",n),X(r)&&w("&assertion","div/mod second argument is zero",r),!t)switch(e){case 0:return Pt(n,r);case 1:return Mt(n,r);case 2:default:return Tt(n,r)}var o=Tt(n,r),a=o[1],u=xt(r);if(wt(H(a,a),u))switch(e){case 0:return H(o[0],Nt(r)?S:I);case 1:return K(a,u);case 2:default:return[H(o[0],Nt(r)?S:I),K(a,u)]}switch(e){case 0:return o[0];case 1:return a;case 2:default:return o}}return n}function N(t,e){if(i(arguments),t=y(t),e=y(e),!ht(t)||!ht(e))return T(t),T(e),_t(e)?ht(t)?F:C:vt(e)?e:t;if(X(e))return t;e=xt(e);var n=U(t)||U(e);n&&(t=Y(t),e=Y(e));var r=K(t,e),o=H(t,e),a=yt(r),u=yt(o);if(V(a,u)){var s=Nt(a);return Nt(u)!=s?n?F:R:(a=s?u:Et(r),n?z(a):a)}for(var c=[];;){if(r=K(r,a),X(r))break;if(o=K(o,a),X(o))break;switch(r=J(r),o=J(o),a=yt(r),St(a,yt(o))){case-1:Gt(c,Et(r));break;case 1:Gt(c,Et(o));break;case 0:default:Gt(c,a);continue}break}for(var g=R,l=c.length;l--;)g=J(H(g,c[l]));return g=H(g,u),n?z(g):g}var y,E,R,I,S,F,C,w,O,T,P,M,q,A,B,D,Z,j,U,k,L,G,$,X,Y,z,W,J,Q,V,H,K,tt,et,nt,rt,it,ot,at,ut,st,ct,gt,lt,ft,dt,mt,pt,ht,_t,vt,xt,bt,Nt,yt,Et,Rt,It,St,Ft,Ct,wt,Ot,Tt,Pt,Mt,qt,At,Bt,Dt,Zt,jt,Ut,kt=t.get("es5globals"),Lt=t.get("uncurry"),Gt=Lt(kt.Array.prototype.push);y=t.get("SchemeNumber"),Z=t.get("numberToString"),j=t.get("isExact"),U=t.get("isInexact"),k=t.get("isComplex"),L=t.get("isReal"),G=t.get("isRational"),$=t.get("isInteger"),X=t.get("isZero"),Y=t.get("toExact"),z=t.get("toInexact"),W=t.get("negate"),J=t.get("reciprocal"),Q=t.get("eq"),V=t.get("ne"),H=t.get("add"),K=t.get("subtract"),tt=t.get("multiply"),et=t.get("divide"),nt=t.get("realPart"),rt=t.get("imagPart"),it=t.get("expt"),ot=t.get("exp"),at=t.get("magnitude"),ut=t.get("angle"),st=t.get("sqrt"),ct=t.get("log"),gt=t.get("asin"),lt=t.get("acos"),ft=t.get("atan"),dt=t.get("sin"),mt=t.get("cos"),pt=t.get("tan"),ht=t.get("SN_isFinite"),_t=t.get("SN_isInfinite"),vt=t.get("SN_isNaN"),xt=t.get("abs"),bt=t.get("isPositive"),Nt=t.get("isNegative"),yt=t.get("floor"),Et=t.get("ceiling"),Rt=t.get("truncate"),It=t.get("round"),St=t.get("compare"),Ft=t.get("gt"),Ct=t.get("lt"),wt=t.get("ge"),Ot=t.get("le"),Tt=t.get("divAndMod"),Pt=t.get("div"),Mt=t.get("mod"),qt=t.get("atan2"),At=t.get("numerator"),Bt=t.get("denominator"),Dt=t.get("isEven"),Zt=t.get("isOdd"),jt=t.get("exactIntegerSqrt"),Ut=t.get("gcdNonnegative"),E=t.get("stringToNumber"),t.onChange.subscribe(e),e(t);var $t={"eqv?":u,"number?":s,"complex?":c,"real?":g,"rational?":l,"integer?":f,"real-valued?":d,"rational-valued?":m,"integer-valued?":p,"exact?":_(y,j),"inexact?":_(y,U),inexact:_(y,z),exact:_(y,Y),"=":h,"<":v(Ct),">":v(Ft),"<=":v(Ot),">=":v(wt),"zero?":_(y,X),"positive?":_(P,bt),"negative?":_(P,Nt),"odd?":_(q,Zt),"even?":_(q,Dt),"finite?":_(P,ht),"infinite?":_(P,_t),"nan?":_(P,vt),max:x(Ft),min:x(Ct),"+":function(){for(var t=R,e=arguments.length,n=0;e>n;)t=H(t,y(arguments[n++]));return t},"*":function(){for(var t=I,e=arguments.length,n=0;e>n;)t=tt(t,y(arguments[n++]));return t},"-":function(t){var e=arguments.length;switch(e){case 0:o(arguments);case 1:return W(y(t))}for(var n=y(t),r=1;e>r;)n=K(n,y(arguments[r++]));return n},"/":function(t){var e=arguments.length;switch(e){case 0:o(arguments);case 1:return J(y(t));case 2:return et(y(t),y(arguments[1]))}for(var n=I,r=1;e>r;)n=tt(n,y(arguments[r++]));return et(y(t),n)},abs:_(P,xt),"div-and-mod":b(!1,2),div:b(!1,0),mod:b(!1,1),"div0-and-mod0":b(!0,2),div0:b(!0,0),mod0:b(!0,1),gcd:function(){for(var t=R,e=arguments.length,n=!0,r=0;e>r;r++){var i=q(arguments[r]);n=n&&j(i),t=Ut(t,Y(xt(i)))}return t=xt(t),n?t:z(t)},lcm:function(){for(var t=I,e=arguments.length,n=!0,r=0;e>r;r++){var i=q(arguments[r]);n=n&&j(i),i=Y(xt(i)),t=et(tt(t,i),Ut(t,xt(i)))}return n?t:z(t)},numerator:_(M,At),denominator:_(M,Bt),floor:_(P,yt),ceiling:_(P,Et),truncate:_(P,Rt),round:_(P,It),rationalize:N,exp:_(y,ot),log:function(t,e){var r=ct(y(t));switch(arguments.length){case 2:r=et(r,ct(y(e)));case 1:return r;default:n("1-2",arguments)}},sin:_(y,dt),cos:_(y,mt),tan:_(y,pt),asin:_(y,gt),acos:_(y,lt),atan:function(t,e){switch(arguments.length){case 1:return ft(y(t));case 2:return qt(P(t),P(e));default:n("1-2",arguments)}},sqrt:_(y,st),"exact-integer-sqrt":_(q,jt),expt:function(t,e){return 2===arguments.length||i(arguments),it(y(t),y(e))},"make-rectangular":function(t,e){return 2===arguments.length||i(arguments),B(P(t),P(e))},"make-polar":function(t,e){return 2===arguments.length||i(arguments),D(P(t),P(e))},"real-part":_(y,nt),"imag-part":_(y,rt),magnitude:_(y,at),angle:_(y,ut),"number->string":function(t,e,r){var i=e;switch(arguments.length){case 3:r=q(r),A(r);case 2:i=A(q(i)).valueOf(),10!==i&&16!==i&&8!==i&&2!==i&&w("&assertion","invalid radix",e);case 1:break;default:n("1-3",arguments)}return Z(y(t),i,r)},"string->number":function(t,e){switch(arguments.length){case 1:case 2:return E(String(t),e);default:n("1-2",arguments)}}},Xt=kt.Object.create(null);for(var Yt in $t)kt.Object.prototype.hasOwnProperty.call($t,Yt)&&(Xt[Yt]=$t[Yt]);return Xt}function implementSchemeNumber(t){"use strict";function e(t){var e;if(t instanceof r)return t;if("string"==typeof t)return e=o(t),e===!1&&u("&assertion","not a number",t),e;if("number"==typeof t)return i(t);try{return a(t)}catch(n){u("&assertion","not a number",t,n)}}function n(t){r=t.get("SchemeNumberType"),i=t.get("nativeToInexact"),o=t.get("stringToNumber"),a=t.get("toSchemeNumber"),u=t.get("raise")}var r,i,o,a,u;return e.VERSION=[1,3,2],e.fn=void 0,e.raise=void 0,e.maxIntegerDigits=1e6,e.plugins=t,t.onChange.subscribe(n),n(t),e}function makeMinimalBase(){var t,e=DispatchJs.makeContext({methodNamePrefix:"SN_",methodNameSeparator:" "}),n=new PluginContainer({Dispatch:e,es5globals:getEs5Globals()});return n.extend(implementUncurry(n)),n.extend(defineGenericFunctions(n)),n.extend(defineSchemeNumberType(n)),n.extend(defineDebugFunction(n)),t=implementSchemeNumber(n),n.extend("SchemeNumber",t),n.extend(implementCoreLibrary(n)),t.raise=n.get("defaultRaise"),t.fn=implementRnrsBase(n),t}function defineAbstractTypes(t){"use strict";function e(){}function n(){}function r(){}function i(){}function o(){}function a(){}var u=t.get("es5globals"),s=u.Object.create(null),c=t.get("SchemeNumberType");return e.prototype=new c,n.prototype=new e,r.prototype=new n,i.prototype=new n,o.prototype=new i,a.prototype=new o,s.Complex=e,s.Real=n,s.InexactReal=r,s.ExactReal=i,s.ExactRational=o,s.ExactInteger=a,s}function installAbstractTypes(t){"use strict";function e(e){n.defClass(e,{ctor:t.get(e)})}var n=t.get("Dispatch");e("Complex"),e("Real"),e("InexactReal"),e("ExactReal"),e("ExactRational"),e("ExactInteger")}function installStubFunctions(t){"use strict";function e(e,n){var r=t.get(e);return r?void i(r.def,r,n):void console.log(e,"not found")}var n=t.get("es5globals"),r=t.get("uncurry"),i=r(n.Function.prototype.apply),o=(r(n.Array.prototype.concat),t.get("SchemeNumberType")),a=t.get("Complex"),u=t.get("Real"),s=(t.get("InexactReal"),t.get("ExactReal"),t.get("ExactRational")),c=t.get("ExactInteger");e("numberToString",[o]),e("isExact",[o]),e("isInexact",[o]),e("isComplex",[o]),e("isReal",[o]),e("isRational",[o]),e("isInteger",[o]),e("isZero",[o]),e("toExact",[o]),e("toInexact",[o]),e("negate",[o]),e("reciprocal",[o]),e("eq",[o,o]),e("ne",[o,o]),e("add",[o,o]),e("subtract",[o,o]),e("multiply",[o,o]),e("divide",[o,o]),e("square",[o]),e("realPart",[a]),e("imagPart",[a]),e("magnitude",[a]),e("angle",[a]),e("conjugate",[a]),e("expt",[o,c]),e("expt",[a,a]),e("exp",[a]),e("sqrt",[a]),e("log",[a]),e("asin",[a]),e("acos",[a]),e("atan",[a]),e("sin",[a]),e("cos",[a]),e("tan",[a]),e("SN_isFinite",[u]),e("SN_isInfinite",[u]),e("SN_isNaN",[u]),e("isUnit",[u]),e("abs",[u]),e("isPositive",[u]),e("isNegative",[u]),e("sign",[u]),e("floor",[u]),e("ceiling",[u]),e("truncate",[u]),e("round",[u]),e("compare",[u,u]),e("gt",[u,u]),e("lt",[u,u]),e("ge",[u,u]),e("le",[u,u]),e("divAndMod",[u,u]),e("div",[u,u]),e("mod",[u,u]),e("atan2",[u,u]),e("numerator",[s]),e("denominator",[s]),e("numeratorAndDenominator",[s]),e("isEven",[c]),e("isOdd",[c]),e("exactIntegerSqrt",[c]),e("exp10",[c]),e("gcdNonnegative",[c,c]),e("divideReduced",[c,c]),e("bitwiseNot",[c]),e("bitwiseAnd",[c,c]),e("bitwiseIor",[c,c]),e("bitwiseXor",[c,c]),e("bitCount",[c]),e("bitLength",[c]),e("firstBitSet",[c]),e("isBitSet",[c]),e("copyBit",[c]),e("bitField",[c]),e("copyBitField",[c,c]),e("bitShift",[c]),e("rotateBitField",[c]),e("reverseBitField",[c])}function implementPluginLibrary(t){"use strict";function e(t,e){un=t.get("nativeToExactInteger"),sn=t.get("divideReducedNotByOne"),cn=t.get("exactRectangular"),gn=t.get("inexactRectangular"),ln=t.get("ZERO"),fn=t.get("ONE"),dn=t.get("TWO"),mn=t.get("MINUS_ONE"),_n=t.get("INEXACT_ZERO"),vn=t.get("INEXACT_ONE"),xn=t.get("PI"),pn=t.get("I"),hn=t.get("MINUS_I")}function n(){return qn(Ee(Ne(this)),pe(ye(this),dn))}function r(){return qn(be(_e(this)),ve(this))}function i(){var t=me(pn,this);return me(pe(de(be(t),be(se(t))),dn),hn)}function o(){var t=me(pn,this);return pe(fe(be(t),be(se(t))),dn)}function a(t,e){if(oe(t)){if(oe(e))return Kt(t)&&Kt(e)?fn:vn;if(Be(_e(e)))return Kt(e)?t:_n;Bn("&implementation-restriction","invalid power for zero expt",e)}return be(me(Re(t),e))}function u(t){return me(hn,Re(fe(me(pn,t),Ee(de(fn,he(t))))))}function s(t){return de(pe(xn,dn),u(t))}function c(t){var e=me(pn,t);return me(pe(de(Re(fe(fn,e)),Re(de(fn,e))),dn),hn)}function g(t){return An(Re(Ne(t)),ye(t))}function l(t){return a(this,t)}function f(){return u(this)}function d(){return s(this)}function m(){return c(this)}function p(){return g(this)}function h(){return oe(ve(this))?_e(this).valueOf():Pn}function _(t,e){return"-"===e[0]||"+"===e[0]?t+e+"i":t+"+"+e+"i"}function v(t,e){return _(Ht(_e(this),t,e),Ht(ve(this),t,e))}function x(t){return t=t||10,_(_e(this).toString(t),ve(this).toString(t))}function b(t){return _(_e(this).toFixed(t),ve(this).toFixed(t))}function N(t){return _(_e(this).toExponential(t),ve(this).toExponential(t))}function y(t){return _(_e(this).toPrecision(t),ve(this).toPrecision(t))}function E(){return te(this)?this:gn(ue(_e(this)),ue(ve(this)))}function R(){return Kt(this)?this:cn(ae(_e(this)),ae(ve(this)))}function I(){return oe(_e(this))&&oe(ve(this))}function S(){var t=_e(this),e=ve(this);return oe(t)?Ae(e):oe(e)?Ae(t):Ee(fe(he(t),he(e)))}function F(){return Ve(ve(this),_e(this))}function C(t){return ge(_e(this),_e(t))&&ge(ve(this),ve(t))}function w(t){return oe(ve(this))&&ge(t,_e(this))}function O(t){return oe(ve(t))&&ge(_e(t),this)}function T(t){return le(_e(this),_e(t))||le(ve(this),ve(t))}function P(t){return!oe(ve(this))||le(t,_e(this))}function M(t){return!oe(ve(t))||le(_e(t),this)}function q(t){return An(fe(this,_e(t)),ve(t))}function A(t){return An(fe(_e(this),t),ve(this))}function B(t){return An(fe(_e(this),_e(t)),fe(ve(this),ve(t)))}function D(t){return An(de(this,_e(t)),se(ve(t)))}function Z(t){return An(de(_e(this),t),ve(this))}function j(t){return An(de(_e(this),_e(t)),de(ve(this),ve(t)))}function U(){return An(se(_e(this)),se(ve(this)))}function k(t,e,n,r){return An(de(me(t,n),me(e,r)),fe(me(t,r),me(e,n)))}function L(t){return An(me(_e(t),this),me(ve(t),this))}function G(t){return An(me(_e(this),t),me(ve(this),t))}function $(t){return k(_e(this),ve(this),_e(t),ve(t))}function X(t){return An(pe(_e(this),t),pe(ve(this),t))}function Y(){var t=_e(this),e=ve(this),n=me(t,e);return An(de(he(t),he(e)),fe(n,n))}function z(){var t=_e(this),e=ve(this),n=fe(he(t),he(e));return An(pe(t,n),se(pe(e,n)))}function W(t,e,n){var r=_e(n),i=ve(n),o=fe(he(r),he(i));return k(t,e,pe(r,o),se(pe(i,o)))}function J(t){return W(this,Kt(this)?ln:_n,t)}function Q(t){return W(_e(this),ve(this),t)}function V(t){return En(t,2)}function H(t){var e=V(Cn(t)),n=Rn(e,".");return-1===n?0:e.length-n-1}function K(t){return On(2,H(t))}function tt(){return me(this,this)}function et(){return!Kt(this)}function nt(t){return!ge(this,t)}function rt(t){return fe(this,se(t))}function it(t){return me(this,ce(t))}function ot(t){return Kt(this)?At(this,t):a(this,t)}function at(){return pe(Ce(this),we(this))}function ut(){return ge(fn,this)||ge(mn,this)}function st(){return Ae(this)}function ct(){return De(this)?xn:_n}function gt(){return De(this)?xn:ln}function lt(){return Ze(this)>0}function ft(){return Ze(this)<0}function dt(){return 0===Ze(this)}function mt(){return Ge(this,ln)}function pt(t){return 0===Ge(this,t)}function ht(t){return 0!==Ge(this,t)}function _t(t){return Ge(this,t)>0}function vt(t){return Ge(this,t)<0}function xt(t){return Ge(this,t)>=0}function bt(t){return Ge(this,t)<=0}function Nt(t,e){return De(e)?Ue(pe(t,e)):je(pe(t,e))}function yt(t){var e=Nt(this,t);return[e,de(this,me(e,t))]}function Et(t){return Nt(this,t)}function Rt(t){return de(this,me(Nt(this,t),t))}function It(){return De(this)?se(this):this}function St(){return ie(this)?this:fe(fn,je(this))}function Ft(){return De(this)?Ue(this):je(this)}function Ct(){var t=je(this),e=de(this,t),n=fe(e,e);switch(Ge(n,fn)){case-1:return t;case 1:return fe(fn,t);case 0:default:return en(t)?t:fe(fn,t)}}function wt(t){return qe(t)?this:sn(this,t)}function Ot(t){var e=this,n=on(Ae(t),Ae(e));return e=Je(e,n),t=Je(t,n),De(t)&&(e=se(e),t=se(t)),qe(t)?e:sn(e,t)}function Tt(){switch(Ze(this)){case-1:return an(mn,se(this));case 1:return an(fn,this);case 0:default:return Dn()}}function Pt(t){var e=tn(this),n=e[0],r=e[1];return qe(r)?Ht(n,t):Ht(n,t)+"/"+Ht(r,t)}function Mt(){return[this,fn]}function qt(t){return me(this,At(un(10),t))}function At(t,e){for(var n,r=Ae(e),i=t,o=fn;Be(r);)n=We(r,dn),r=n[0],oe(n[1])||(o=me(o,i)),i=he(i);return De(e)?ce(o):o}function Bt(t){return At(this,t)}function Dt(t){for(var e,n=this;!oe(n);)e=n,n=Qe(t,n),t=e;return t}function Zt(){return de(mn,this)}function jt(t){var e=In("000000000000000",0,15&t);return t>15&&(e+=yn(new bn.Array((t>>4)+1),"0000000000000000")),e}function Ut(t){var e=t===Tn?0:Mn(t,10);if(e>Gt.maxIntegerDigits)throw new RangeError("fractionDigits exceeds SchemeNumber.maxIntegerDigits: "+t);var n=this,r="";De(n)&&(n=se(n),r="-");var i=rn(fn,un(-e)),o=We(n,i),a=o[0];if(Ye(fe(o[1],o[1]),i)&&(a=fe(fn,a)),oe(a))return r+"0"+(t>0?"."+jt(t):"");if(a=Ht(a),0===e)return r+a;var u=e-a.length;if(e>0){u>=0&&(a=jt(u+1)+a);var s=a.length-e;return r+In(a,0,s)+"."+In(a,s)}return r+a+jt(-e)}function kt(t){var e=t===Tn?20:Mn(t,10);if(0>e)throw new RangeError("SchemeNumber toExponential: negative argument: "+e);if(e>Gt.maxIntegerDigits)throw new RangeError("fractionDigits exceeds SchemeNumber.maxIntegerDigits: "+t);var n=this,r="";if(De(n))n=se(n),r="-";else if(oe(n))return"0"+(t>0?"."+jt(e):"")+"e+0";var i=wn(Re(n)/Fn),o=rn(fn,un(i-e)),a=We(n,o),u=a[0];return Ye(fe(a[1],a[1]),o)&&(u=fe(fn,u)),u=Ht(u),u.length!=e+1&&(i+=u.length-(e+1),o=rn(fn,un(i-e)),a=We(n,o),u=a[0],Ye(fe(a[1],a[1]),o)&&(u=fe(fn,u)),u=Ht(u),u.length!=e+1)?Ht(this):(t===Tn&&(u=Sn(u,/(\d)0+$/,"$1")),u.length>1&&(u=u[0]+"."+In(u,1)),r+u+"e"+(0>i?"":"+")+i)}function Lt(t){var e,n;if(t===Tn){if(n=ue(this),Te(n))return En(+n);e=21}else{if(e=Mn(t,10),1>e)throw new RangeError("SchemeNumber toPrecision: expected a positive precision, got: "+t);if(e>Gt.maxIntegerDigits)throw new RangeError("precision exceeds SchemeNumber.maxIntegerDigits: "+t)}n=this;var r="";if(De(n))n=se(n),r="-";else if(oe(n))return"0"+(e>1?"."+jt(e-1):"");var i=n.toExponential(e-1),o=Rn(i,"e"),a=Mn(In(i,o+1),10);return a>=-6&&e>a?0===a?i=In(i,0,o):(i=In(i,0,1)+(-1===Rn(i,".")?"":In(i,2,o)),0>a?i="0."+jt(-1-a)+i:e-1>a&&(i=In(i,0,a+1)+"."+In(i,a+1))):t===Tn&&(i=Sn(In(i,0,o),/\.?0+/,"")+In(i,o)),r+i}var Gt,$t,Xt,Yt,zt,Wt,Jt,Qt,Vt,Ht,Kt,te,ee,ne,re,ie,oe,ae,ue,se,ce,ge,le,fe,de,me,pe,he,_e,ve,xe,xe,be,Ne,ye,Ee,Re,Ie,Se,Fe,Ce,we,Oe,Te,Pe,Me,qe,Ae,Be,De,Ze,je,Ue,ke,Le,Ge,$e,Xe,Ye,ze,We,Je,Qe,Ve,He,Ke,tn,en,nn,rn,on,an;Gt=t.get("SchemeNumber"),Xt=t.get("SchemeNumberType"),Yt=t.get("Complex"),zt=t.get("Real"),Wt=t.get("InexactReal"),Jt=t.get("ExactReal"),Qt=t.get("ExactRational"),Vt=t.get("ExactInteger"),$t=t.get("toSchemeNumber"),Ht=t.get("numberToString"),Kt=t.get("isExact"),te=t.get("isInexact"),ee=t.get("isComplex"),ne=t.get("isReal"),re=t.get("isRational"),ie=t.get("isInteger"),oe=t.get("isZero"),ae=t.get("toExact"),ue=t.get("toInexact"),se=t.get("negate"),ce=t.get("reciprocal"),ge=t.get("eq"),le=t.get("ne"),fe=t.get("add"),de=t.get("subtract"),me=t.get("multiply"),pe=t.get("divide"),he=t.get("square"),_e=t.get("realPart"),ve=t.get("imagPart"),xe=t.get("expt"),xe=t.get("expt"),be=t.get("exp"),Ne=t.get("magnitude"),ye=t.get("angle"),Ee=t.get("sqrt"),Re=t.get("log"),Ie=t.get("asin"),Se=t.get("acos"),Fe=t.get("atan"),Ce=t.get("sin"),we=t.get("cos"),Oe=t.get("tan"),Te=t.get("SN_isFinite"),Pe=t.get("SN_isInfinite"),Me=t.get("SN_isNaN"),qe=t.get("isUnit"),Ae=t.get("abs"),Be=t.get("isPositive"),De=t.get("isNegative"),Ze=t.get("sign"),je=t.get("floor"),Ue=t.get("ceiling"),ke=t.get("truncate"),Le=t.get("round"),Ge=t.get("compare"),$e=t.get("gt"),Xe=t.get("lt"),Ye=t.get("ge"),ze=t.get("le"),We=t.get("divAndMod"),Je=t.get("div"),Qe=t.get("mod"),Ve=t.get("atan2"),He=t.get("numerator"),Ke=t.get("denominator"),tn=t.get("numeratorAndDenominator"),en=t.get("isEven"),nn=t.get("isOdd"),rn=t.get("exp10"),on=t.get("gcdNonnegative"),an=t.get("divideReduced");var un,sn,cn,gn,ln,fn,dn,mn,pn,hn,_n,vn,xn,bn=t.get("es5globals"),Nn=t.get("uncurry"),yn=Nn(bn.Array.prototype.join),En=Nn(bn.Number.prototype.toString),Rn=Nn(bn.String.prototype.indexOf),In=Nn(bn.String.prototype.substring),Sn=Nn(bn.String.prototype.replace),Fn=bn.Math.LN10,Cn=(bn.Math.LN2,bn.Math.abs),wn=bn.Math.floor,On=bn.Math.pow,Tn=bn.undefined,Pn=bn.NaN,Mn=bn.parseInt,qn=(bn.isFinite,t.get("makePolar")),An=t.get("makeRectangular"),Bn=t.get("raise"),Dn=t.get("raiseDivisionByExactZero"),Zn=bn.Object.create(null);return t.onChange.subscribe(e),e(t,{}),Zn.Complex_sqrt=n,Zn.Complex_exp=r,Zn.Complex_sin=i,Zn.Complex_cos=o,Zn.Complex_expt_fn=a,Zn.Complex_expt=l,Zn.Complex_asin_fn=u,Zn.Complex_asin=f,Zn.Complex_acos_fn=s,Zn.Complex_acos=d,Zn.Complex_atan_fn=c,Zn.Complex_atan=m,Zn.Complex_log_fn=g,Zn.Complex_log=p,Zn.Complex_numberToString=v,Zn.Complex_toString=x,Zn.Complex_toFixed=b,Zn.Complex_toExponential=N,Zn.Complex_toPrecision=y,Zn.Complex_toInexact=E,Zn.Complex_toExact=R,Zn.Complex_isZero=I,Zn.Complex_magnitude=S,Zn.Complex_angle=F,Zn.Complex_eq=C,Zn.Complex_eq_Real=w,Zn.Real_eq_Complex=O,Zn.Complex_ne=T,Zn.Complex_ne_Real=P,Zn.Real_ne_Complex=M,Zn.Real_add_Complex=q,Zn.Complex_add_Real=A,Zn.Complex_add=B,Zn.Real_subtract_Complex=D,Zn.Complex_subtract_Real=Z,Zn.Complex_subtract=j,Zn.Complex_negate=U,Zn.Real_multiply_Complex=L,Zn.Complex_multiply_Real=G,Zn.Complex_multiply=$,Zn.Complex_divide_Real=X,Zn.Complex_square=Y,Zn.Complex_reciprocal=z,Zn.Real_divide_Complex=J,Zn.Complex_divide=Q,Zn.numberToBinary=V,Zn.nativeDenominatorLog2=H,Zn.nativeDenominator=K,Zn.square_via_multiply=tt,Zn.isInexact_via_isExact=et,Zn.ne_via_eq=nt,Zn.subtract_via_negate_add=rt,Zn.divide_via_reciprocal_multiply=it,Zn.complex_or_exact_expt=ot,Zn.tan_via_divide_sin_cos=at,Zn.isUnit_via_eq=ut,Zn.Real_magnitude_via_abs=st,Zn.InexactReal_angle_via_isNegative=ct,Zn.ExactReal_angle_via_isNegative=gt,Zn.isPositive_via_sign=lt,Zn.isNegative_via_sign=ft,Zn.isZero_via_sign=dt,Zn.sign_via_compare=mt,Zn.eq_via_compare=pt,Zn.ne_via_compare=ht,Zn.gt_via_compare=_t,
Zn.lt_via_compare=vt,Zn.ge_via_compare=xt,Zn.le_via_compare=bt,Zn.divAndMod_via_divide_floor=yt,Zn.div_via_divide_floor=Et,Zn.mod_via_divide_floor=Rt,Zn.abs_via_isNegative_negate=It,Zn.ceiling_via_floor=St,Zn.truncate_via_ceiling_floor=Ft,Zn.round_via_floor_compare_isEven=Ct,Zn.divideReduced_via_isUnit=wt,Zn.Integer_divide_via_gcd_div=Ot,Zn.Integer_reciprocal_via_divideReduced=Tt,Zn.ExactRational_numberToString=Pt,Zn.Integer_numeratorAndDenominator=Mt,Zn.genericExp10=qt,Zn.expt_N_EI_fn=At,Zn.expt_N_EI=Bt,Zn.gcdNonnegative_via_isZero_mod=Dt,Zn.bitwiseNot_via_subtract=Zt,Zn.Real_toFixed=Ut,Zn.Real_toExponential=kt,Zn.Real_toPrecision=Lt,Zn.Complex_valueOf=h,Zn}function installGenericFunctions(t){"use strict";function e(e,n,r){var i=t.get(e);if(i){var o=void 0;return r&&(o=t.get(r),!o)?void console.log(r+" not defined"):void i.def.apply(i.def,n.concat(o))}}var n=t.get("SchemeNumberType"),r=t.get("Complex"),i=t.get("Real"),o=t.get("InexactReal"),a=t.get("ExactReal"),u=t.get("ExactRational"),s=t.get("ExactInteger");t.get("raise");e("expt",[n,s],"expt_N_EI"),e("square",[n],"square_via_multiply"),e("isInexact",[n],"isInexact_via_isExact"),e("ne",[n,n],"ne_via_eq"),e("subtract",[n,n],"subtract_via_negate_add"),e("divide",[n,n],"divide_via_reciprocal_multiply"),e("isComplex",[r],"retTrue"),e("numberToString",[r],"Complex_numberToString"),e("sqrt",[r],"Complex_sqrt"),e("exp",[r],"Complex_exp"),e("log",[r],"Complex_log"),e("sin",[r],"Complex_sin"),e("cos",[r],"Complex_cos"),e("tan",[r],"tan_via_divide_sin_cos"),e("asin",[r],"Complex_asin"),e("acos",[r],"Complex_acos"),e("atan",[r],"Complex_atan"),e("toInexact",[r],"Complex_toInexact"),e("toExact",[r],"Complex_toExact"),e("isZero",[r],"Complex_isZero"),e("magnitude",[r],"Complex_magnitude"),e("angle",[r],"Complex_angle"),e("eq",[r,r],"Complex_eq"),e("eq",[r,i],"Complex_eq_Real"),e("eq",[i,r],"Real_eq_Complex"),e("ne",[r,r],"Complex_ne"),e("ne",[r,i],"Complex_ne_Real"),e("ne",[i,r],"Real_ne_Complex"),e("add",[i,r],"Real_add_Complex"),e("add",[r,i],"Complex_add_Real"),e("add",[r,r],"Complex_add"),e("subtract",[i,r],"Real_subtract_Complex"),e("subtract",[r,i],"Complex_subtract_Real"),e("subtract",[r,r],"Complex_subtract"),e("negate",[r],"Complex_negate"),e("multiply",[i,r],"Real_multiply_Complex"),e("multiply",[r,i],"Complex_multiply_Real"),e("multiply",[r,r],"Complex_multiply"),e("divide",[r,i],"Complex_divide_Real"),e("square",[r],"Complex_square"),e("reciprocal",[r],"Complex_reciprocal"),e("divide",[i,r],"Real_divide_Complex"),e("divide",[r,r],"Complex_divide"),e("isReal",[i],"retTrue"),e("realPart",[i],"retThis"),e("imagPart",[i],"retZero"),e("conjugate",[i],"retThis"),e("isUnit",[i],"isUnit_via_eq"),e("magnitude",[i],"Real_magnitude_via_abs"),e("isPositive",[i],"isPositive_via_sign"),e("isNegative",[i],"isNegative_via_sign"),e("isZero",[i],"isZero_via_sign"),e("sign",[i],"sign_via_compare"),e("eq",[i,i],"eq_via_compare"),e("ne",[i,i],"ne_via_compare"),e("gt",[i,i],"gt_via_compare"),e("lt",[i,i],"lt_via_compare"),e("ge",[i,i],"ge_via_compare"),e("le",[i,i],"le_via_compare"),e("divAndMod",[i,i],"divAndMod_via_divide_floor"),e("div",[i,i],"div_via_divide_floor"),e("mod",[i,i],"mod_via_divide_floor"),e("abs",[i],"abs_via_isNegative_negate"),e("ceiling",[i],"ceiling_via_floor"),e("truncate",[i],"truncate_via_ceiling_floor"),e("round",[i],"round_via_floor_compare_isEven"),e("isExact",[o],"retFalse"),e("isInexact",[o],"retTrue"),e("toInexact",[o],"retThis"),e("angle",[o],"InexactReal_angle_via_isNegative"),e("isExact",[a],"retTrue"),e("isInexact",[a],"retFalse"),e("toExact",[a],"retThis"),e("SN_isNaN",[a],"retFalse"),e("SN_isFinite",[a],"retTrue"),e("SN_isInfinite",[a],"retFalse"),e("angle",[a],"ExactReal_angle_via_isNegative"),e("isRational",[u],"retTrue"),e("divideReduced",[s,s],"divideReduced_via_isUnit"),e("divide",[s,s],"Integer_divide_via_gcd_div"),e("reciprocal",[s],"Integer_reciprocal_via_divideReduced"),e("isInteger",[s],"retTrue"),e("numerator",[s],"retThis"),e("denominator",[s],"retOne"),e("floor",[s],"retThis"),e("ceiling",[s],"retThis"),e("round",[s],"retThis"),e("truncate",[s],"retThis"),e("exp10",[s],"genericExp10"),e("gcdNonnegative",[s,s],"gcdNonnegative_via_isZero_mod"),e("bitwiseNot",[s],"bitwiseNot_via_subtract"),e("expt",[r,r],"Complex_expt"),e("expt",[a,s],"expt_N_EI"),e("expt",[r,s],"complex_or_exact_expt"),e("numberToString",[u],"ExactRational_numberToString"),e("numberToString",[s],void 0),e("numeratorAndDenominator",[s],"Integer_numeratorAndDenominator")}function installEcmaMethods(t){"use strict";var e=t.get("SchemeNumberType"),n=t.get("ExactReal"),r=t.get("Complex"),i=t.get("Real");t.get("ExactRational");r.prototype.valueOf=t.get("Complex_valueOf"),r.prototype.toString=t.get("Complex_toString"),r.prototype.toFixed=t.get("Complex_toFixed"),r.prototype.toExponential=t.get("Complex_toExponential"),r.prototype.toPrecision=t.get("Complex_toPrecision"),i.prototype.valueOf=e.prototype.valueOf,i.prototype.toFixed=e.prototype.toFixed,i.prototype.toExponential=e.prototype.toExponential,i.prototype.toPrecision=e.prototype.toPrecision,i.prototype.toString=e.prototype.toString,n.prototype.toFixed=t.get("Real_toFixed"),n.prototype.toExponential=t.get("Real_toExponential"),n.prototype.toPrecision=t.get("Real_toPrecision")}function makeBase(){var t=makeMinimalBase(),e=t.plugins;return t.makeMinimalBase=makeMinimalBase,t.makeBase=makeBase,e.extend(implementPluginLibrary(e)),e.extend(defineAbstractTypes(e)),installAbstractTypes(e),installStubFunctions(e),installGenericFunctions(e),installEcmaMethods(e),t}function installDefaultExactInteger(t,e){function n(n){function i(t){return o(e(this),e(t))}var o=t.get(n);o.def(r,r,i)}var r=t.get("ExactInteger");n("compare"),n("add"),n("subtract"),n("multiply"),n("expt"),n("divAndMod"),n("div"),n("mod"),n("gcdNonnegative"),t.extend("canonicalExactInteger",e)}function installDefaultRational(t,e,n){function r(n){function r(t){return i(e(this),e(t))}var i=t.get(n);i.def(a,a,r)}function i(t){return n(this,t)}var o=t.get("ExactInteger"),a=t.get("ExactRational");r("compare"),r("add"),r("subtract"),r("multiply"),r("divide"),t.get("divideReduced").def(o,o,i),t.extend("canonicalRational",e)}function implementNativeInexactReal(t){"use strict";function e(t){this._=t}function n(){return"NativeInexact("+this._+")"}function r(){return this._}function i(t){return h(this._,t)}function o(t){return _(this._,t)}function a(t){return v(this._,t)}function u(t){return x(this._,t)}function s(){return b(this._)}function c(t){return 0===t?y:new e(t)}function g(t,e){return c(t*N(e))}function l(t){function e(t){return c(r(t))}function n(t,e){return c(r(t,e))}var r=f.Math[t];p["Native_"+t]=1===r.length?e:n}var f=t.get("es5globals"),d=t.get("uncurry"),m=t.get("InexactReal"),p=f.Object.create(null),h=d(f.Number.prototype.toFixed),_=d(f.Number.prototype.toExponential),v=d(f.Number.prototype.toPrecision),x=d(f.Number.prototype.toString),b=d(f.Number.prototype.toLocaleString),N=f.parseFloat;e.prototype=new m,e.prototype.valueOf=r,e.prototype.toFixed=i,e.prototype.toExponential=o,e.prototype.toPrecision=a,e.prototype.toString=u,e.prototype.toLocaleString=s;var y=new e(0);return l("log"),l("sqrt"),l("atan2"),l("atan"),l("cos"),l("sin"),l("tan"),l("exp"),l("abs"),l("floor"),l("ceil"),l("pow"),p.parseInexact=g,p.nativeToInexact=c,p.NativeInexactReal=e,p.NativeInexactReal_debug=n,p}function implementNativeFlonumLibrary(t){"use strict";function e(t){$=t.get("nativeToInexact"),X=t.get("Native_log"),Y=t.get("Native_sqrt"),z=t.get("Native_atan2"),W=t.get("Native_atan"),J=t.get("Native_cos"),Q=t.get("Native_sin"),V=t.get("Native_tan"),H=t.get("Native_exp"),K=t.get("Native_abs"),tt=t.get("Native_floor"),et=t.get("Native_ceil"),nt=t.get("Native_pow"),rt=t.get("raise"),it=t.get("inexactRectangular"),ot=t.get("INEXACT_ZERO"),at=t.get("nativeToExactInteger"),st=t.get("divideReducedNotByOne"),ut=t.get("TWO"),ct=t.get("numberToString"),gt=t.get("isExact"),lt=t.get("isInexact"),ft=t.get("toExact"),dt=t.get("toInexact"),mt=t.get("isRational"),pt=t.get("isInteger"),ht=t.get("isZero"),_t=t.get("negate"),vt=t.get("square"),xt=t.get("eq"),bt=t.get("ne"),Nt=t.get("add"),yt=t.get("subtract"),Et=t.get("multiply"),Rt=t.get("divide"),It=t.get("expt"),St=t.get("exp"),Ft=t.get("sqrt"),Ct=t.get("log"),wt=t.get("asin"),Ot=t.get("acos"),Tt=t.get("atan"),Pt=t.get("sin"),Mt=t.get("cos"),qt=t.get("tan"),At=t.get("abs"),Bt=t.get("isPositive"),Dt=t.get("isNegative"),Zt=t.get("sign"),jt=t.get("floor"),Ut=t.get("ceiling"),kt=t.get("truncate"),Lt=t.get("round"),Gt=t.get("compare"),$t=t.get("gt"),Xt=t.get("lt"),Yt=t.get("ge"),zt=t.get("le"),Wt=t.get("divAndMod"),Jt=t.get("div"),Qt=t.get("mod"),Vt=t.get("atan2"),Ht=t.get("numerator"),Kt=t.get("denominator"),te=t.get("isEven"),ee=t.get("isOdd"),ne=t.get("Complex_expt_fn"),re=t.get("Complex_acos_fn"),ie=t.get("Complex_asin_fn"),oe=t.get("Complex_log_fn"),ae=t.get("numberToBinary"),ue=t.get("nativeDenominatorLog2"),se=t.get("nativeDenominator")}function n(){return $(Number(this))}function r(t,e){var n=+this;if(t&&10!=t&&ye(n))return"#i"+ct(ft(this),t);if(!ye(n))return Ee(n)?"+nan.0":n>0?"+inf.0":"-inf.0";var r=pe(n);if(-1===fe(r,".")){var i=fe(r,"e");-1===i?r+=".":r=de(r,0,i)+"."+de(r,i)}if(e!=Re){if(53>e){var o=me(me(me(ae(+this),/[-+.]/g,""),/^0+/,""),/0+$/,"").length;o>e&&(e=o)}r+="|"+e}return r}function i(){var t=+this;return ye(t)||rt("&assertion","not a rational number",t),nt(2,ue(t))}function o(){var t=+this;return ye(t)||rt("&assertion","not a rational number",t),$(this*se(t))}function a(){var t=+this;return ye(t)&&t===be(t)}function u(){return ye(+this)}function s(){var t=+this;return!ye(t)&&!Ee(t)}function c(){return Ee(+this)}function g(){return 0===+this}function l(){return+this>0}function f(){return 0>+this}function d(){var t=+this;return 0===t?0:t>0?1:-1}function m(){return 0===(1&+this)}function p(){return 1===(1&+this)}function h(t){return+this===+t}function _(t){return+this!==+t}function v(t){return+this>+t}function x(t){return+t>+this}function b(t){return+this>=+t}function N(t){return+t>=+this}function y(t){var e=+this;return t=+t,e===t?0:t>e?-1:e>t?1:NaN}function E(){var t=+this;ye(t)||rt("&implementation-violation","inexact argument has no reasonably close exact equivalent",this);var e,n=se(t);if(1===n)return at(t);if(ye(n))e=t*n,n=at(n);else{var r=ue(t);e=9007199254740992*t,e*=natPow(2,r-53),n=It(ut,at(r))}return st(at(e),n)}function R(t){return $(+this+ +t)}function I(t){return $(+this-+t)}function S(t){return $(+this*+t)}function F(t){return $(+this/+t)}function C(){return $(-+this)}function w(){return $(he(+this))}function O(){return $(1/+this)}function T(t,e){return e>0?be(t/e):0>e?xe(t/e):NaN}function P(t){var e=+this;t=+t;var n=T(e,t);return[$(n),$(e-t*n)]}function M(t){var e=+this;return t=+t,$(T(e,t))}function q(t){var e=+this;return t=+t,$(e-t*T(e,t))}function A(){var t=+this;return $(t*t)}function B(t){var e=+this;return 0>e?ne(this,t):nt(e,t)}function D(){var t=+this,e=be(t),n=t-e;return $(.5>n?e:n>.5?e+1:2*Ne(t/2))}function Z(){var t=+this;return 0>t?et(t):tt(t)}function j(t){return function(){return t(+this)}}function U(t,e){return function(){var n=+this,r=t(n);return Ee(r)?e(this):$(r)}}function k(){var t=+this;return 0>t?oe(this):X(t)}function L(){var t=+this;return t>=0?Y(t):Ee(t)?$(t):it(ot,Y(-t))}function G(t){return z(+this,t)}var $,X,Y,z,W,J,Q,V,H,K,tt,et,nt,rt,it,ot,at,ut,st,ct,gt,lt,ft,dt,mt,pt,ht,_t,vt,xt,bt,Nt,yt,Et,Rt,It,St,Ft,Ct,wt,Ot,Tt,Pt,Mt,qt,At,Bt,Dt,Zt,jt,Ut,kt,Lt,Gt,$t,Xt,Yt,zt,Wt,Jt,Qt,Vt,Ht,Kt,te,ee,ne,re,ie,oe,ae,ue,se,ce=t.get("es5globals"),ge=t.get("uncurry"),le=ce.Object.create(null),fe=ge(ce.String.prototype.indexOf),de=ge(ce.String.prototype.substring),me=ge(ce.String.prototype.replace),pe=ge(ce.Number.prototype.toString),he=(ce.Math.E,ce.Math.LN10,ce.Math.LN2,ce.Math.LOG2E,ce.Math.LOG10E,ce.Math.PI,ce.Math.SQRT1_2,ce.Math.SQRT2,ce.Math.abs),_e=ce.Math.acos,ve=ce.Math.asin,xe=(ce.Math.atan,ce.Math.atan2,ce.Math.ceil),be=(ce.Math.cos,ce.Math.exp,ce.Math.floor),Ne=(ce.Math.log,ce.Math.max,ce.Math.min,ce.Math.pow,ce.Math.random,ce.Math.round),ye=(ce.Math.sin,ce.Math.sqrt,ce.Math.tan,ce.isFinite),Ee=ce.isNaN,Re=(ce.parseFloat,ce.undefined);ce.Number;t.onChange.subscribe(e),e(t);var Ie=j(et),Se=j(tt),Fe=j(W),Ce=j(J),we=j(H),Oe=j(Q),Te=j(V),Pe=U(_e,re),Me=U(ve,ie);return le.Real_toInexact_via_Flonum=n,le.Flonum_numberToString=r,le.Flonum_isRational=u,le.Flonum_denominator=i,le.Flonum_numerator=o,le.Flonum_isInteger=a,le.Flonum_SN_isFinite=u,le.Flonum_SN_isInfinite=s,le.Flonum_SN_isNaN=c,le.Flonum_isZero=g,le.Flonum_isPositive=l,le.Flonum_isNegative=f,le.Flonum_sign=d,le.Flonum_isEven=m,le.Flonum_isOdd=p,le.Flonum_eq=h,le.Flonum_ne=_,le.Flonum_gt=v,le.Flonum_lt=x,le.Flonum_ge=b,le.Flonum_le=N,le.Flonum_compare=y,le.Flonum_toExact=E,le.Flonum_add=R,le.Flonum_subtract=I,le.Flonum_multiply=S,le.Flonum_divide=F,le.Flonum_negate=C,le.Flonum_abs=w,le.Flonum_reciprocal=O,le.Flonum_divAndMod=P,le.Flonum_div=M,le.Flonum_mod=q,le.Flonum_square=A,le.Flonum_expt=B,le.Flonum_round=D,le.Flonum_truncate=Z,le.Flonum_ceiling=Ie,le.Flonum_floor=Se,le.Flonum_atan=Fe,le.Flonum_cos=Ce,le.Flonum_exp=we,le.Flonum_sin=Oe,le.Flonum_tan=Te,le.Flonum_acos=Pe,le.Flonum_asin=Me,le.Flonum_log=k,le.Flonum_sqrt=L,le.Flonum_atan2=G,le}function installFlonum(t){"use strict";function e(e){var n=t.get("Flonum_"+e);n||console.log("Flonum_"+e+" not defined"),t.get(e).def(c,n)}function n(e){var n=t.get("Flonum_"+e);n||console.log("Flonum_"+e+" not defined"),t.get(e).def(l,n)}function r(e){var n=t.get("Flonum_"+e);n||console.log("Flonum_"+e+" not defined"),t.get(e).def(g,n)}function i(e){var n=t.get(e),r=t.get("Flonum_"+e);r||console.log("Flonum_"+e+" not defined"),n.def(c,c,r)}function o(e){var n=t.get(e),r=t.get("Flonum_"+e);i(e),n.def(f,c,r),n.def(c,f,r)}function a(e){var n=t.get(e),r=t.get("Flonum_"+e);i(e),n.def(g,l,r),n.def(l,g,r)}function u(e){var n=t.get(e),r=t.get("Flonum_"+e);i(e),n.def(g,g,r)}var s,c=t.get("Flonum"),g=t.get("Real"),l=t.get("InexactReal"),f=t.get("ExactReal"),d=!0;if(!(c.prototype instanceof l))for(s in l.prototype)s in c.prototype||(c.prototype[s]=l.prototype[s]);d&&t.get("toInexact").def(f,t.get("Real_toInexact_via_Flonum"));var m=d?n:e,p=d?r:e,h=d?a:o,_=d?u:o;m("numberToString"),m("isRational"),m("denominator"),m("numerator"),m("isInteger"),m("SN_isFinite"),m("SN_isInfinite"),m("SN_isNaN"),m("isZero"),m("isPositive"),m("isNegative"),m("sign"),m("isEven"),m("isOdd"),m("toExact"),m("negate"),m("abs"),m("reciprocal"),m("square"),m("round"),m("truncate"),m("ceiling"),m("floor"),p("atan"),p("cos"),p("exp"),p("sin"),p("tan"),p("acos"),p("asin"),p("log"),p("sqrt"),h("eq"),h("ne"),h("gt"),h("lt"),h("ge"),h("le"),h("compare"),h("add"),h("subtract"),h("multiply"),h("divide"),h("divAndMod"),h("div"),h("mod"),_("expt"),_("atan2")}function implementBigInteger(t,e){"use strict";function n(t,e){$=t.get("nativeToInexact"),X=t.get("inexactRectangular"),Y=t.get("ZERO"),z=t.get("ONE"),W=t.get("MINUS_ONE"),Q=t.get("PI"),V=t.get("INEXACT_ZERO")}function r(){return et+"("+this.toString()+")"}function i(t,n,r){var i=e.parse(rt(n,/^0+/,""),r);return 0>t&&(i=i.negate()),i}function o(t){return e.parse(nt(t,16),16)}function a(){return e.parse(A(this))}function u(t){q("&implementation-restriction","exact integer would exceed limit of "+ +tt.maxIntegerDigits+" digits; adjust SchemeNumber.maxIntegerDigits",t)}function s(t){if(this.isZero())return t.isZero()?z:this;if(this.isUnit())return this.isPositive()?this:t.isEven()?z:this;t=t.valueOf();var e=this.pow(st(t));return t>=0?e:U(e)}function c(t){return this.toString(t)}function g(t,e){var n=t.divRem(e);return n[1].isNegative()?e.isNegative()?[n[0].next(),n[1].subtract(e)]:[n[0].prev(),n[1].add(e)]:n}function l(t){return g(this,t)}function f(t){return g(this,t)[0]}function d(t){return g(this,t)[1]}function m(){var t=$(this.abs().log());return this.isPositive()?t:X(t,Q)}function p(t){switch(L(t)){case 0:return this;case-1:return k(this,G(z,D(t)));case 1:return t=+t,t>tt.maxIntegerDigits&&!this.isZero()&&u(t),this.exp10(t)}}function h(){var t=this.sign();if(0===t)return this;var e=$(ct(this.abs().log()/2));return 0>t?X(V,e):e}function _(){function t(t,e){for(;;){var n=t.divRem(e),r=n[0],i=e.subtract(r);if(i.isZero())return[r,n[1]];if(i.isUnit())return i.isPositive()?[r,r.add(n[1])]:[e,e.add(n[1])];e=r.add(i.quotient(2))}}switch(this.sign()){case-1:q("&assertion","negative number",this);case 0:return[Y,Y];case 1:}var n=this.log()/2/at;if(7>n){var r=this.valueOf(),i=gt(ft(r));return[e(i),e(r-i*i)]}var o=e(nt(lt(10,n-gt(n)))+"e"+gt(n));return t(this,o)}function v(t){var e=this;if(e.isZero())return t;for(var n,r=t;;){if(n=e,e=r.remainder(e),e.isZero())return n;r=n}}function x(t){function n(n){for(var r,i,a=this,u=e.ZERO,s=e.ONE;;){if(i=a.divRem(J),r=+i[1],a=i[0],i=n.divRem(J),r=t(r,+i[1]),n=i[0],0>r&&(r+=4294967296),u=u.add(s.multiply(o(r))),a.isZero())break;s=s.multiply(J)}return t(0,1)&&(u=u.add(n.multiply(s))),u}return n}function b(t){return t+1}function N(){if(!pt)for(pt=[0];pt.length<256;)pt=it(pt,ot(pt,b));return pt}function y(){if(!ht)for(ht=[0];ht.length<256;)ht=ht.concat(ht),ht[0]++;return ht}function E(){for(var t,e,n,r=this,i=0;!r.isZero();)t=r.divRem(J),r=t[0],e=+t[1],n=N(),i+=n[e>>0&255],i+=n[e>>8&255],i+=n[e>>16&255],i+=n[e>>24&255];return o(i)}function R(){var t=this;switch(t.sign()){case 0:return Y;case-1:t=e.M_ONE.subtract(t)}var n=t.log()/ut,r=gt(n),i=e.pow(2,gt(n));if(i.compare(t)>0)for(;;){if(t=t.add(t),i.compare(t)<=0)return o(r);r--}for(;;)if(i=i.add(i),r++,i.compare(t)>0)return o(r)}function I(){var t,e,n,r=this;if(r.isZero())return W;for(n=0;t=r.divRem(J),e=t[1],e.isZero();n+=32)r=t[0];for(e=+e;0===(255&e);)n+=8,e>>=8;return o(n+y()[255&e])}function S(t){var n=e.pow(2,+t);return this.remainder(n.add(n)).compare(n)>=0}function F(t,n){var r=e.pow(2,+t),i=this.remainder(r.add(r)).compare(r)>=0;switch(n-i){case 0:return this;case 1:return this.add(r);case-1:return this.subtract(r)}}function C(t,n){t=+t;var r=e.pow(2,n-t),i=e.pow(2,t);return this.quotient(i).remainder(r)}function w(t,n,r){n=+n;var i=e.pow(2,r-n),o=e.pow(2,n),a=this.quotient(o).remainder(i);return this.add(o.multiply(t.subtract(a).quotient(i)))}function O(t){var n=e.pow(2,+Z(t));return B(t)?this.quotient(n):this.multiply(n)}function T(t,n,r){t=+t;var i=n-t;if(2>i)return this;if(r=+j(r,o(i)),0===r)return this;var a=e.pow(2,i),u=e.pow(2,t),s=e.pow(2,r),c=this.quotient(u).remainder(a),g=c.multiply(s);return g=g.add(g.quotient(a)).remainder(a),this.add(u.multiply(g.subtract(c)))}function P(t,n){var r;t=+t;var i=e.pow(2,n-t),o=e.pow(2,+t),a=this.quotient(o).remainder(i),u=a.toString(2),s=u.length-1;if(1>s)return this;var c="";for(r=0;r<u.length;r++)c+=u[s-r];var g=e.parse(c,2);return this.add(g.subtract(a).multiply(o))}function M(){function n(n,r){t.get(n).def(e,r)}function i(n,r){t.get(n).def(e,e,r)}function o(n){t.get(n).def(e,e.prototype[n])}function u(n){t.get(n).def(e,e,e.prototype[n])}var g=t.get("Dispatch"),x=t.get("ExactInteger"),b=t.get("debug"),N=t.get("retThis");g.defClass("BigInteger",{ctor:e,base:"ExactInteger"}),e.init(),b.def(e,r),mt.def(e,N),mt.def(x,a),i("expt",s),n("numberToString",c),o("isZero"),o("isEven"),o("isOdd"),o("sign"),o("isUnit"),o("isPositive"),o("isNegative"),o("negate"),o("abs"),o("square"),u("compare"),u("add"),u("subtract"),u("multiply"),n("log",m),n("exp10",p),n("sqrt",h),n("exactIntegerSqrt",_),i("divAndMod",l),i("div",f),i("mod",d),i("gcdNonnegative",v),i("bitwiseAnd",_t),i("bitwiseIor",vt),i("bitwiseXor",xt),n("bitCount",E),n("bitLength",R),n("firstBitSet",I),n("isBitSet",S),n("copyBit",F),n("bitField",C),i("copyBitField",w),n("bitShift",O),n("rotateBitField",T),n("reverseBitField",P)}var q,A,B,D,Z,j,U,k,L,G,$,X,Y,z,W,J,Q,V,H=t.get("es5globals"),K=t.get("uncurry"),tt=t.get("SchemeNumber"),et=e.name||"BigInteger",nt=K(H.Number.prototype.toString),rt=K(H.String.prototype.replace),it=K(H.Array.prototype.concat),ot=K(H.Array.prototype.map),at=H.Math.LN10,ut=H.Math.LN2,st=H.Math.abs,ct=H.Math.exp,gt=H.Math.floor,lt=H.Math.pow,ft=H.Math.sqrt,dt=H.Object.create(null),mt=t.get("Dispatch").defGeneric("to"+et,1);q=t.get("raise"),A=t.get("numberToString"),B=t.get("isNegative"),D=t.get("negate"),Z=t.get("abs"),j=t.get("mod"),U=t.get("reciprocal"),k=t.get("divide"),L=t.get("sign"),G=t.get("exp10"),J=o(4294967296),t.onChange.subscribe(n),n(t);var pt,ht,_t=x(function(t,e){return t&e}),vt=x(function(t,e){return t|e}),xt=x(function(t,e){return t^e});return dt.parseExactInteger=i,dt.nativeToExactInteger=o,dt.importExactInteger=mt,dt.install=M,dt}function defaultRationalFactory(t){"use strict";function e(t,e){this._n=t,this._d=e}function n(){return"Fraction("+Z(this._n)+" / "+Z(this._d)+")"}function r(){var t=this._n,e=this._d,n=t/e;if(ht(n))return n;switch(ot(t)){case 1:return pt(K(t)-K(e));case-1:return-pt(K(H(t))-K(e));case 0:default:return 0}}function i(){return this._n}function o(){return this._d}function a(t,n){return new e(t,n)}function u(t,n){return U(n)?t:new e(t,n)}function s(){var t=k(this);return u(t[0],t[1])}function c(){return[this._n,this._d]}function g(t){return Y(this._d,t._d)&&Y(this._n,t._n)}function l(t){var e=ot(this._n)-ot(t._n);return 0!==e?e>0?1:-1:t._d===this._d?z(this._n,t._n):z(Q(this._n,t._d),Q(this._d,t._n))}function f(t){return z(this._n,Q(this._d,t))}function d(t){return z(Q(this,t._d),t._n)}function m(){return ot(this._n)}function p(){return gt(this._n)}function h(){return et(this._n)}function _(){return a(H(this._n),this._d)}function v(){return a(st(this._n),st(this._d))}function x(){var t=this._n;switch(ot(t)){case-1:return u(H(this._d),H(t));case 1:return u(this._d,t);case 0:default:lt()}}function b(t){return V(W(Q(this._n,t._d),Q(t._n,this._d)),Q(this._d,t._d))}function N(t){return a(W(this._n,Q(t,this._d)),this._d)}function y(t){return a(W(Q(this,t._d),t._n),t._d)}function E(t){return V(J(Q(this._n,t._d),Q(t._n,this._d)),Q(this._d,t._d))}function R(t){return a(J(this._n,Q(t,this._d)),this._d)}function I(t){return a(J(Q(this,t._d),t._n),t._d)}function S(t){return V(Q(this._n,t._n),Q(this._d,t._d))}function F(t,e,n){var r=k(V(n,e));return u(Q(t,r[0]),r[1])}function C(t){return F(this._n,this._d,t)}function w(t){return F(t._n,t._d,this)}function O(t){return V(Q(this._n,t._d),Q(this._d,t._n))}function T(t){var n=k(V(this._n,t));return new e(n[0],Q(n[1],this._d))}function P(t){return V(Q(this,t._d),t._n)}function M(t){var e,n;switch(ot(t)){case 0:return G;case 1:e=this._n,n=this._d;break;case-1:default:if(e=this._d,n=this._n,t=nt(t),et(n)&&(e=H(e),n=H(n)),U(n))return ut(e,t)}return a(ut(e,t),ut(n,t))}function q(){var t,e=nt(this._n),n=rt(e),r=rt(this._d);return t=it(n)?it(r)?V(n,r):tt(J(K(n),V(K(this._d),$))):tt(J(V(K(e),$),it(r)?K(r):V(K(this._d),$))),et(this._n)?X(L,t):t}function A(){return J(K(this._n),K(this._d))}function B(){return at(this._n,this._d)}function D(){function r(e,n,r,i){t.get(e).def(n,r,i)}function a(n,r){t.get(n).def(e,r)}function u(n,r){t.get(n).def(e,e,r)}var F=t.get("Dispatch"),D=t.get("ExactInteger");F.defClass("Fraction",{ctor:e}),_t.def(e,t.get("retThis")),_t.def(ft,s),a("debug",n),a("numerator",i),a("denominator",o),a("numeratorAndDenominator",c),a("isInteger",j),u("eq",g),r("eq",e,D,j),r("eq",D,e,j),u("compare",l),r("compare",e,D,f),r("compare",D,e,d),a("sign",m),a("isPositive",p),a("isNegative",h),a("isZero",j),a("isUnit",j),a("floor",B),a("negate",_),a("square",v),a("reciprocal",x),u("add",b),r("add",e,D,N),r("add",D,e,y),u("subtract",E),r("subtract",e,D,R),r("subtract",D,e,I),u("multiply",S),r("multiply",e,D,C),r("multiply",D,e,w),u("divide",O),r("divide",e,D,T),r("divide",D,e,P),r("expt",e,D,M),a("sqrt",q),a("log",A)}var Z,j,U,k,L,G,$,X,Y,z,W,J,Q,V,H,K,tt,et,nt,rt,it,ot,at,ut,st,ct,gt,et,lt,ft=t.get("ExactRational"),dt=t.get("es5globals"),mt=(t.get("uncurry"),dt.Object.create(null)),pt=dt.Math.exp,ht=(dt.isNaN,dt.isFinite);Z=t.get("debug"),j=t.get("retFalse"),U=t.get("isUnit"),k=t.get("numeratorAndDenominator"),L=t.get("ZERO"),G=t.get("ONE"),$=t.get("TWO"),X=t.get("makeRectangular"),Y=t.get("eq"),z=t.get("compare"),W=t.get("add"),J=t.get("subtract"),Q=t.get("multiply"),V=t.get("divide"),H=t.get("negate"),K=t.get("log"),tt=t.get("exp"),et=t.get("isNegative"),nt=t.get("abs"),rt=t.get("sqrt"),it=t.get("SN_isFinite"),ot=t.get("sign"),at=t.get("div"),ut=t.get("expt"),st=t.get("square"),ct=t.get("isZero"),gt=t.get("isPositive"),et=t.get("isNegative"),lt=t.get("raiseDivisionByExactZero"),e.prototype=new ft,e.prototype.valueOf=r;var _t=t.get("Dispatch").defGeneric("toFraction",1);return mt.divideReducedNotByOne=a,mt.divideReduced=u,mt.importRational=_t,mt.install=D,mt}function implementRectangular(t){"use strict";function e(t){R=t.get("ZERO"),I=t.get("ONE"),S=t.get("MINUS_ONE"),F=t.get("INEXACT_ZERO")}function n(t,e){this._x=t,this._y=e}function r(){return this._x}function i(){return this._y}function o(){return _(this._x)?u(this._x,b(this._y)):s(this._x,b(this._y))}function a(){return"Rectangular("+d(this._x)+", "+d(this._y)+")"}function u(t,e){return m(e)?t:m(t)&&p(e)?h(e)?T:P:new n(t,e)}function s(t,e){return new n(t,e)}function c(t,e){return s(N(y(e),t),N(E(e),t))}function g(t,e){return c(x(t),x(e))}function l(){return _(this._x)}function f(){return v(this._x)}var d,m,p,h,_,v,x,b,N,y,E,R,I,S,F,C=(t.get("Real"),t.get("Complex")),w=t.get("es5globals"),O=(t.get("uncurry"),w.Object.create(null));d=t.get("debug"),m=t.get("isZero"),p=t.get("isUnit"),h=t.get("isPositive"),_=t.get("isExact"),v=t.get("isInexact"),x=t.get("toInexact"),b=t.get("negate"),N=t.get("multiply"),y=t.get("cos"),E=t.get("sin"),t.onChange.subscribe(e),e(t),n.prototype=new C;var T=new n(R,I),P=new n(R,S);return O.Rectangular=n,O.Rectangular_debug=a,O.Rectangular_realPart=r,O.Rectangular_imagPart=i,O.Rectangular_conjugate=o,O.exactRectangular=u,O.inexactRectangular=s,O.exactPolar=g,O.inexactPolar=c,O.Rectangular_isExact=l,O.Rectangular_isInexact=f,O}function installRectangular(t){function e(e,n){var i=t.get(n);i||console.log(n+" is not defined"),t.get(e).def(r,i)}function n(t){e(t,"Rectangular_"+t)}var r=t.get("Rectangular");e("isReal","retFalse"),e("isRational","retFalse"),e("isInteger","retFalse"),n("realPart"),n("imagPart"),n("isExact"),n("isInexact"),n("conjugate")}function defaultIntegerFactory(plugins){var BigInteger;if(BigInteger="undefined"!=typeof require?require("./biginteger").BigInteger:this.BigInteger,!BigInteger)if("undefined"!=typeof load)load("biginteger.js");else{if(!this.readFile)throw new Error("BigInteger is not defined.");eval(this.readFile("biginteger.js"))}return implementBigInteger(plugins,BigInteger)}function configure(t){var e=makeBase(),n=e.plugins,r=n.get("Dispatch"),i=n.get("debug")||{def:function(){}},o=t.integerFactory||defaultIntegerFactory,a=t.rationalFactory||defaultRationalFactory,u=o(n);u.install(),n.extend("nativeToExactInteger",u.nativeToExactInteger,"parseExactInteger",u.parseExactInteger),installDefaultExactInteger(n,u.importExactInteger);var s=a(n);s.install(),n.extend("divideReducedNotByOne",s.divideReducedNotByOne),installDefaultRational(n,s.importRational,s.divideReduced);var c=implementRectangular(n),g=c.Rectangular;n.extend(c),r.defClass("Rectangular",{ctor:g}),i.def(g,c.Rectangular_debug),installRectangular(n);var l=implementNativeInexactReal(n),f=l.NativeInexactReal;return n.extend("Flonum",f),n.extend(l),n.extend(implementNativeFlonumLibrary(n)),r.defClass("NativeInexactReal",{ctor:f}),i.def(f,l.NativeInexactReal_debug),installFlonum(n),e}var DispatchJs=function(){"use strict";function t(t){return String(t).replace(/(?:.|\n)*(function .*?\(.*?\))(?:.|\n)*/,"$1")}function e(e){function r(t){if(null!=t){var e=t[I];if("string"==typeof e){if(C[e]&&C[e].ctor===t)return e;for(e in C)if(C[e]&&C[e].ctor===t)return e}}}function i(t){if("string"==typeof t)return t;var e=r(t);if(e)return e;throw f("Class not defined: "+t)}function o(){var t="Abstract method not overridden for ";try{t+=this}catch(e){try{t+=c.prototype.toString.call(this)}catch(e){t+="object"}}throw new f(t)}var a=e.globals,u=a?a.Function:Function,s=u.prototype.bind.bind(u.prototype.call),c=a?a.Object:Object,g=a?a.String:String,l=a?a.Array:Array,f=a?a.Error:Error,d=s(u.prototype.apply),m=s(l.prototype.slice),p=s(l.prototype.join),h=s(l.prototype.push),_=(s(l.prototype.unshift),s(l.prototype.forEach)),v=s(l.prototype.concat),x=s(g.prototype.replace),b=s(g.prototype.split),N=c.create,y=s(c.prototype.hasOwnProperty),E=s(g.prototype.indexOf),R=s(l.prototype.indexOf),I=e.methodNamePrefix||"_jsmd",S=x(I,/([\"\\])/g,"\\$1"),F=e.methodNameSeparator||" ",C=N(null),w={getConstructor:function(t){return C[t]&&C[t].ctor},defClass:function(e,n){var o,a,u,s,c,g,l,d,m,_,v,S,w,O,T;if(n.debug&&console.log("defClass: ",e),n&&(o=n.ctor,n.base&&(a=i(n.base))),"undefined"==typeof a&&o&&null!=o.prototype&&(a=r(o.prototype.constructor)),"undefined"!=typeof a&&(u=C[a].ctor),o=o||function(){},"string"!=typeof e)throw f("Usage: defClass(NAME, [OPTS])");if(C[e]){if(C[e].ctor!==o||C[e].base!==a)throw f("Can't redefine class "+e);return o}if(-1!=E(e,F))throw f((" "==F?"Space":"Separator")+" in class name: "+e);if("undefined"!=typeof o[I]){if(o[I]!==e)throw f("Cannot define constructor as "+e+", it was previously defined as "+o[I])}else o[I]=e;if(o.prototype)if(y(o.prototype,"constructor")){if(o.prototype.constructor!==o)throw f("ctor.prototype.constructor is not ctor")}else o.prototype.constructor=o;if(!o.prototype||u&&!(o.prototype instanceof u)){if(s=u?new u:N(null),o.prototype)for(c in o.prototype)s[c]=o.prototype[c];s.constructor=o,o.prototype=s}if(C[e]={ctor:o,base:a,sub:[],ename:x(F+e,/([\"\\])/g,"\\$1")},"undefined"!=typeof a){g=C[a].sub,-1===R(g,e)&&h(g,e),l=F+a;for(d in C){s=C[d].ctor.prototype;for(m in s)if(y(s,m)&&E(m,l)&&(S=b(m,F),S[0]===I)){for(v=s[m],T=[],O=R(S,a,2);-1!==O;O=R(S,a,O+1))h(T,O);w=function(r){return r===T.length?(_=p(S,F),void(_!==m&&(n.debug&&console.log(d+'["'+_+'"] propagated -> '+t(v)),s[_]=v))):(S[T[r]]=a,w(r+1),S[T[r]]=e,void w(r+1))},w(0)}}}return o},defGeneric:function(r,a,s){function c(t,e){var r=p(m(e,t),"");if(!q[r]){var i=S+w+r,o=v(m(n,0,t),m(n,t+1,s));h(o,"return "+n[t-1]+'["'+i+'"]('+p(v(m(n,0,t-1),"this",m(n,t+1,s)),",")+")"),q[r]=d(u,null,o)}return q[r]}function g(){switch(a){case 1:return"TYPE";case 2:return"TYPE1, TYPE2";case 3:return"TYPE1, TYPE2, TYPE3";default:return"TYPE1, ..., TYPE"+a}}function b(){var t=arguments[a]||o;if("function"!=typeof t)throw f("Not a function.  Usage: "+r+".def("+g()+", FUNCTION)");var e=m(arguments,0,a);for(T=0;a>T;T++)e[T]=i(e[T]);R(e,t,N(null))}function R(n,i,o){function u(r,i){function a(t){u(r-1,i+F+t),_(C[t].sub,a)}var s,c=m[r].ctor.prototype;if(c[i]&&c[i]!==f[r])return void(e.debug&&console.log("Skipping "+r+" "+n[r]+'["'+i+'"] '+t(c[i])+"!="+t(f[r])));if(c===Object.prototype)throw Error("BUG: code would modify Object.prototype.");c[i]!==d[r]&&(s=n[r]+F+i,s in o&&d[r]===o[s]?(e.debug&&console.log(p[r]+'["'+i+'"] '+t(c[i])+" -> DELETED"),delete c[i]):(e.debug&&console.log(p[r]+'["'+i+'"] '+t(c[i])+" -> "+t(d[r])),y(c,i)||(o[s]=c[i]),c[i]=d[r])),0!==r&&a(n[r])}var s,g,f,d,m=new l(a),p=new l(a);for(s=0;a>s;s++)m[s]=C[n[s]],p[s]=m[s].ename;for(e.debug&&console.log("do_def",r,p),f=new Array(a),s=a-1,g="";f[s]=m[s].ctor.prototype[I+F+r+g],0!==s;s--)g=p[s]+g;for(d=new l(a),d[0]=i,s=1;a>s;s++)d[s]=c(s,p);u(a-1,I+F+r)}if(-1!=E(r,F))throw f((" "==F?"Space":"Separator")+" in function name: "+r);if(s=s||a,""==r||1>a||a!=(0|a)||1>s||s!=(0|s))throw Error("Usage: defGeneric(NAME, NDISP [, NARGS])");for(var w=x(F+r,/([\"\\])/g,"\\$1"),O=S+w,T=n.length;s>T;T++)n[T]="a"+T;var P=m(n,0,s);h(P,"return "+n[a-1]+'["'+O+'"]('+p(v(m(P,0,a-1),m(P,a,s)),",")+")");var M=d(u,null,P),q=N(null);return M.def=b,M}};return e.debug&&(w.classes=C),w}var n=[],r=e(Object.create(null));return r.makeContext=e,r}(),SchemeNumber=configure({});return SchemeNumber.configure=configure,SchemeNumber}();"undefined"!=typeof exports&&(exports.SchemeNumber=SchemeNumber);
